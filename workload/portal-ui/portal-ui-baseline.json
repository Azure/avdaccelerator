{
    "$schema": "<relative path to createFormUI.schema.json>",
    "view": {
        "kind": "Form",
        "properties": {
            "isWizard": false,
            "title": "AVD Landing Zone Accelerator - Baseline",
            "steps": [
                {
                    "name": "basics",
                    "label": "Deployment Basics",
                    "elements": [
                        {
                            "name": "deploymentInfo",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Important Information",
                            "elements": [
                                {
                                    "name": "infoPreReq",
                                    "type": "Microsoft.Common.InfoBox",
                                    "options": {
                                        "text": "PREREQUISITES REQUIRED \n\nThere are prerequisites that must be setup in your Azure environment to successfully deploy this AVD Landing Zone Accelerator. Click here to review the prerequisites in the Getting Started guide.",
                                        "uri": "https://github.com/Azure/avdaccelerator/blob/main/workload/docs/getting-started-baseline.md",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "deploymentInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "options": {
										"style": "Info",
                                        "text": "The subscription selected in the 'Project details' section below will be used to deploy all resources. \n\nThe region selected in 'Instance details' section below will be used to deploy the AVD management plane resources (workspace, host pool, and application group, etc.). These resource types are not available in all regions, but they are globally replicated.\n\nThe session hosts do not have to be deployed to the same region, therefore you will have the option to select that region on the 'Session Hosts' blade.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/data-locations"										
                                    }
                                }
                            ]
                        },
                        {
                            "name": "resourceScope",
                            "type": "Microsoft.Common.ResourceScope",
                            "location": {
                                "resourceTypes": [
                                    "Microsoft.DesktopVirtualization/workspaces"
                                ]
                            }
                        },
                        {
                            "name": "infoResourceGroupNaming",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Azure AVD Landing Zones will create the resource group hierarchy under the subscriptions with the prefix provided in this step.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-group-and-subscription-organization"
                                }
                            }
                        },
                        {
                            "name": "deploymentPrefix",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Deployment prefix",
                            "toolTip": "Provide a prefix (max 4 characters) for the resource groups and resources created as part of AVD landing zones.",
                            "placeholder": "Example: app1",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z-]{1,4}$",
                                "validationMessage": "The prefix must be 1-4 characters."
                            }
                        }
                    ]
                },
                {
                    "name": "identity",
                    "label": "Identity",
                    "elements": [
                        {
                            "name": "identityInfo",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "AVD landing zone accelerator deployment expects identity service to be already available in the current Azure estate.",
                                "uri": "https://docs.microsoft.com/azure/virtual-desktop/authentication#identities",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "identityDomainInformation",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Domain to join",
                            "elements": [
                                {
                                    "name": "identityServiceProvider",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": true,
                                    "label": "Identity service provider",
                                    "defaultValue": "Active Directory (AD DS)",
                                    "toolTip": "Identity service provider (ADDS or AADDS) that already exist and will be used for Azure Virtual Desktop.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Azure Active Directory (AAD)",
                                                "value": "AAD"
                                            },
                                            {
                                                "label": "Active Directory (AD DS)",
                                                "value": "ADDS"
                                            },
                                            {
                                                "label": "Azure AD Domain Services (AAD DS)",
                                                "value": "AADDS"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "identityServiceProviderIntuneEnrollment",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD')]",
                                    "label": "Enroll VM with Intune",
                                    "defaultValue": "No",
                                    "toolTip": "If Intune is configured in your Azure AD tenant, you can choose to have the VM automatically enrolled during the deployment by selecting Yes.",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "identityDomainName",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                                    "label": "Domain name",
                                    "toolTip": "Provide identity service domain name.",
                                    "placeholder": "Example: contoso.com",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "identityServiceProviderInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                                    "options": {
                                        "text": "Identity service provider must already exist, as they are a prerequisite for the AVD LZA deployment.",
                                        "uri": "https://github.com/Azure/avdaccelerator/blob/main/workload/docs/getting-started.md",
                                        "style": "Info"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "identityAvdUserAccess",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "AVD users' role assignment",
                            "elements": [
                                {
                                    "name": "identityAccessTypes",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": true,
                                    "label": "Identity type",
                                    "defaultValue": "Groups",
                                    "toolTip": "Select the type of identities that will be entered in the 'Identities ObjectIDs' field.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Groups",
                                                "value": "Group"
                                            },
                                            {
                                                "label": "Users",
                                                "value": "User"
                                            },
                                            {
                                                "label": "Service Principals",
                                                "value": "ServicePrincipal"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "identityAccessIds",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Identities ObjectIDs",
                                    "toolTip": "Comma separated list of identities (ObjectIDs) to be granted access to AVD published items and to create sessions on VMs and single sign-on (SSO) when using AAD as identity provider.",
                                    "placeholder": "Example: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX,XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
                                }

                            ]
                        },
                        {
                            "name": "identityDomainCredentials",
                            "type": "Microsoft.Common.Section",
                            "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                            "label": "Domain join credentials",
                            "elements": [
                                {
                                    "name": "identityDomainJoinUserName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Username",
                                    "toolTip": "Provide username with permissions to join session host to the domain.",
                                    "placeholder": "Example: avdadmin@contoso.com",
                                    "defaultValue": "",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "identityDomainJoinUserPassword",
                                    "type": "Microsoft.Common.PasswordBox",
                                    "label": {
                                        "password": "Password"
                                    },
                                    "toolTip": "Provide password for domain join account.",
                                    "constraints": {
                                        "required": true
                                    },
                                    "options": {
                                        "hideConfirmation": false
                                    }
                                }
                            ]
                        },
                        {
                            "name": "identityLocalCredentials",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Session host local admin credentials",
                            "elements": [
                                {
                                    "name": "identityLocalUserName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Username",
                                    "toolTip": "Provide username for session host local admin account.",
                                    "placeholder": "Example: avdadmin",
                                    "defaultValue": "",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "identityLocalUserPassword",
                                    "type": "Microsoft.Compute.CredentialsCombo",
                                    "visible": true,
                                    "label": {
                                        "password": "Password",
                                        "confirmPassword": "Confirm password"
                                    },
                                    "toolTip": {
                                        "password": "The password must be alphanumeric, contain at least 12 characters, have at least 1 letter,1 number and 1 special character."
                                    },
                                    "constraints": {
                                        "required": true
                                    },
                                    "options": {
                                        "hideConfirmation": false
                                    },
                                    "osPlatform": "Windows"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "managementPlane",
                    "label": "Management plane",
                    "elements": [
                        {
                            "name": "managementPlaneHostPoolSettings",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Host pool settings",
                            "elements": [
                                {
                                    "name": "hostPoolType",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": true,
                                    "label": "Host pool type",
                                    "defaultValue": "Pooled",
                                    "multiLine": true,
                                    "toolTip": "",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Pooled",
                                                "description": "",
                                                "value": "Pooled"
                                            },
                                            {
                                                "label": "Personal",
                                                "description": "",
                                                "value": "Personal"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "hostPoolWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "icon": "Warning",
                                        "text": "Host pool type can not be changed after deployment.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/environment-setup"
                                    }
                                },
                                {
                                    "name": "loadBalancerType",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "label": "Load balancing algorithm",
                                    "defaultValue": "BreadthFirst",
                                    "multiLine": true,
                                    "toolTip": "Breadth-first load balancing distributes new user sessions across all available session hosts in the host pool. Depth-first load balancing distributes new user sessions to an available session host with the highest number of connections but has not reached its maximum session limit threshold.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "BreadthFirst",
                                                "description": "Each new user is placed on the next VM. (Performance Optimized)",
                                                "value": "BreadthFirst"
                                            },
                                            {
                                                "label": "DepthFirst",
                                                "description": "Each new user is placed on the same VM until max sessions limit. (Cost Optimized)",
                                                "value": "DepthFirst"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "maxSessions",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "label": "Max session limit",
                                    "defaultValue": "5",
                                    "toolTip": "The maximum number of users that have concurrent sessions on a session host. When setting a host pool to have depth first load balancing or planning to use Autoscaling, you must set an appropriate max session limit according to the configuration of your deployment and capacity of your VMs.",
                                    "constraints": {
                                        "required": false,
                                        "regex": "",
                                        "validationMessage": ""
                                    }
                                },
                                {
                                    "name": "assignmentType",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Personal')]",
                                    "label": "Machine assignment",
                                    "defaultValue": "Automatic (Recommended)",
                                    "multiLine": true,
                                    "toolTip": "Automatic assignment – The service will select an available host and assign it to an user. Direct assignment – Admin selects a specific host to assign to an user.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Automatic (Recommended)",
                                                "description": "Users are assigned an available VM the first time they connect.",
                                                "value": "Automatic"
                                            },
                                            {
                                                "label": "Direct",
                                                "description": "An administrator assigns a VM for each individual user.",
                                                "value": "Direct"
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "managementPlaneAppGroupOptions",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                            "label": "Application group options (Desktop application group will be deployed by default)",
                            "elements": [
                                {
                                    "name": "deployRemoteAppGroup",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": true,
                                    "label": "Create remote app group",
                                    "defaultValue": "Yes (Recommended)",
                                    "toolTip": "This application group type allows to publish seamless apps instead of full desktops.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Recommended)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "managementPlaneHostPoolScaling",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Session host scaling options",
                            "elements": [
                                {
                                    "name": "scalingPlan",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "label": "AVD scaling plan",
                                    "defaultValue": "Yes (Recommended)",
                                    "toolTip": "Will automatically manage session host power state based on usage and schedules (weekdays and weekend schedules will be created). ",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Recommended)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "startVmOnConnect",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Personal')]",
                                    "label": "Start VM on connect",
                                    "defaultValue": "Yes (Recommended)",
                                    "toolTip": "If powered off, start VM once user connects. ",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Recommended)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "createVmRole",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolScaling.startVmOnConnect, true)]",
                                    "label": "Create start VM on connect role",
                                    "defaultValue": "Yes (Required if using Start VM On Connect)",
                                    "toolTip": "Create custom Azure IAM role for Start VM on Connect",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Required if using Start VM On Connect)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "avdEnterpriseApplication",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[or(equals(steps('managementPlane').managementPlaneHostPoolScaling.scalingPlan, true), equals(steps('managementPlane').managementPlaneHostPoolScaling.startVmOnConnect, true))]",
                                    "label": "AVD enterprise application ObjectID",
                                    "defaultValue": "",
                                    "toolTip": "Provide the ObjectID of the enterprise application Azure Virtual Desktop (Name can also be displayed as 'Windows Virtual Desktops'). To get the ObjectID got to Azure AD > Enterprise applications, remove all filters and search for 'Virtual Desktops' and copy the OjectID that is paired with the Application ID: 9cdead84-a844-4324-93f2-b2e6bb768d07.",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "scalingPlanInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "options": {
                                        "text": "Session hosts can be excluded from the scaling plan by assigning the tag name Exclude-avdScalingPlanName, if not using custom resource naming and example of default tag name is Exclude-vdscaling-eus2-app1-001.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/autoscale-scenarios#scenario-4-how-do-exclusion-tags-work",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "vmRoleWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('managementPlane').managementPlaneHostPoolScaling.createVmRole, false)]",
                                    "options": {
                                        "text": "Start VM on Connect will not work without a custom role definition. If you enable start on connect, but do not specify a custom role VM's will not start on-demand. Only select no if this custom role already exists and is assigned to your AVD subscription.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/start-virtual-machine-connect",
                                        "style": "Warning"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "sessionHosts",
                    "label": "Session hosts",
                    "elements": [
                        {
                            "name": "deploySessionHosts",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy session hosts",
                            "defaultValue": "Yes",
                            "toolTip": "Create session hosts compute and storage resources.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "sessionHostsRegionSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('sessionHosts').deploySessionHosts, true)]",
                            "label": "Region Settings",
                            "tooltip": "The section allows you to specify the region where the compute, storage, and key vault resources are deployed.",
                            "elements": [
                                {
                                    "name": "sessionHostsRegion",
                                    "type": "Microsoft.Common.LocationSelector",
                                    "label": "Session Hosts Region",
                                    "defaultValue": "[steps('basics').resourceScope.location.name]",
                                    "toolTip": "Select the region where the session hosts and required resources are to be deployed.",
                                    "resourceTypes": [
                                        "Microsoft.Compute/virtualMachines"
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "sessionHostsComputeStorageSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('sessionHosts').deploySessionHosts, true)]",
                            "label": "General settings",
                            "tooltip": "This settings apply to compute, storage, image management and key vault resources.",
                            "elements": [
                                {
                                    "name": "identityDomainOuPath",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                                    "label": "Session hosts OU path (Optional)",
                                    "toolTip": "Provide OU where to locate session hosts, if not provided session hosts will be placed on the default (computers) OU.",
                                    "placeholder": "Example: OU=session-hosts,OU=avd,DC=contoso,DC=com",
                                    "constraints": {}
                                },
                                { 
                                    "name": "sessionHostsAvailabilitySettings",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Use availability zones",
                                    "defaultValue": "No",
                                    "toolTip": "Distribute compute resources across availability zones. If 'No' is selected then an availability set will be created to host the VMs.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "fslogixDeploymentDisabledAad",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD')]",
                                    "options": {
                                        "text": "FSLogix for Azure AD joined session hosts is currently not globally available (GA).",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "fslogixDeployment",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                                    "label": "Use FSLogix profile management",
                                    "defaultValue": "Yes",
                                    "toolTip": "Deploys FSLogix containers and session host setup for user's profiles.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },	
                                {
                                    "name": "identityDomainOuPathStorageExisting",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true)]",
                                    "label": "Existing storage OU path (Optional)",
                                    "toolTip": "Provide OU where to locate storage account file share, if not provided session hosts will be placed on the default (computers) OU.",
                                    "placeholder": "Example: OU=storage,OU=avd,DC=contoso,DC=com",
                                    "constraints": {}
                                },
                                {
                                    "name": "storageAccountSku",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true)]",
                                    "label": "File share sku",
                                    "filter": true,
                                    "defaultValue": "Premium_LRS",
                                    "toolTip": "Storage account SKU for FSLogix storage. Recommended tier is Premium_ZRS when avaiable otherwise Premium_LRS.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Premium_LRS",
                                                "description": "",
                                                "value": "Premium_LRS"
                                            },
                                            {
                                                "label": "Premium_ZRS (When available)",
                                                "description": "",
                                                "value": "Premium_ZRS"
                                            },
                                            {
                                                "label": "Standard_LRS",
                                                "description": "",
                                                "value": "Standard_LRS"
                                            },
                                            {
                                                "label": "Standard_ZRS (When available)",
                                                "description": "",
                                                "value": "Standard_ZRS"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "sessionHostsFslogixFileShareQuota",
                                    "type": "Microsoft.Common.Slider",
                                    "visible": "[equals (steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true)]",
                                    "label": "File share size",
                                    "subLabel": "x 100GB",
                                    "toolTip": "Size of Azure File share quota, the maximum sizes are 5TB for standard SKU and 100TB for premium SKU",
                                    "min": 1,
                                    "max": 100,
                                    "defaultValue": 1,
                                    "showStepMarkers": true,
                                    "constraints": {
                                        "required": true
                                    }
                                }
                            ]
                        },
                        {
                            "name": "sessionHostsSettingsSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('sessionHosts').deploySessionHosts, true)]",
                            "label": "Session hosts settings",
                            "elements": [
                                {
                                    "name": "sessionHostSize",
                                    "type": "Microsoft.Compute.SizeSelector",
                                    "label": "VM Size",
                                    "toolTip": "",
                                    "recommendedSizes": [
                                        "Standard_D2s_v3"
                                    ],
                                    "constraints": {
                                        "allowedSizes": [],
                                        "excludedSizes": [],
                                        "required": true
                                    },
                                    "options": {
                                        "hideDiskTypeFilter": true
                                    },
                                    "osPlatform": "Windows",
                                    "imageReference": {
                                        "publisher": "MicrosoftWindowsDesktop",
                                        "offer": "Windows-11",
                                        "sku": "21h2-avd"
                                    }
                                },
                                {
                                    "name": "sessionHostsCount",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "VM count",
                                    "toolTip": "Provide the number of session hosts to deploy (1-49).",
                                    "defaultValue": 1,
                                    "constraints": {
                                        "required": true,
                                        "regex": "^([1-9]|[1-4][0-9])$",
                                        "validationMessage": "The count must be between 1-49 session hosts."
                                    }
                                },
                                {
                                    "name": "sessionHostDiskType",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "OS Disk type",
                                    "filter": true,
                                    "defaultValue": "Standard",
                                    "toolTip": "Select session host disk type to host the OS.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Standard",
                                                "value": "Standard_LRS"
                                            },
                                            {
                                                "label": "Premium",
                                                "value": "Premium_LRS"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "sessionHostEncryptionAtHostWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsSettingsSection.sessionHostEncryptionAtHost, true)]",
                                    "options": {
                                        "text": "Encryption at host requires feature EncryptionAtHost of resource provider Microsoft.Compute to be registered in the subscription.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-machines/disks-enable-host-based-encryption-portal?msclkid=31c2d29bbce111ec8bca8257221ab9d1",
                                        "style": "Warning"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "sessionHostsOsSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('sessionHosts').deploySessionHosts, true)]",
                            "label": "OS selection",
                            "elements": [
                                {
                                    "name": "sessionHostsImageSource",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "OS image source",
                                    "filter": true,
                                    "defaultValue": "Marketplace",
                                    "toolTip": "Select marketplace or build custom image to deploy the session hosts.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Marketplace",
                                                "value": false
                                            },
                                            {
                                                "label": "Compute Gallery",
                                                "value": true
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "sessionHostsOsImage",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsOsSection.sessionHostsImageSource, false)]",
                                    "label": "OS version",
                                    "filter": true,
                                    "defaultValue": "Windows 11 22H2 (Gen2)",
                                    "toolTip": "Select the operating system version of the session hosts.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Windows 10 21H2",
                                                "value": "win10_21h2"
                                            },
                                            {
                                                "label": "Windows 10 21H2 - Office 365",
                                                "value": "win10_21h2_office"
                                            },
                                            {
                                                "label": "Windows 10 22H2 (Gen2)",
                                                "value": "win10_22h2_g2"
                                            },
                                            {
                                                "label": "Windows 10 22H2 - Office 365 (Gen2)",
                                                "value": "win10_22h2_office_g2"
                                            },
                                            {
                                                "label": "Windows 11",
                                                "value": "win11_21h2"
                                            },
                                            {
                                                "label": "Windows 11 - Office 365",
                                                "value": "win11_21h2_office"
                                            },
                                            {
                                                "label": "Windows 11 22H2 (Gen2)",
                                                "value": "win11_22h2"
                                            },
                                            {
                                                "label": "Windows 11 22H2 - Office 365 (Gen2)",
                                                "value": "win11_22h2_office"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "sessionHostsComputeGalleryImage",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsOsSection.sessionHostsImageSource, true)]",
                                    "label": "Image",
                                    "resourceType": "Microsoft.Compute/galleries/images",
                                    "constraints": {
                                        "required": true
                                    }
                                }
                            ]
                        },
                        {
                            "name": "sessionHostsSecuritySection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[and(equals(steps('sessionHosts').deploySessionHosts, true), or(contains(steps('sessionHosts').sessionHostsOsSection.sessionHostsOsImage, 'win11'), contains(steps('sessionHosts').sessionHostsOsSection.sessionHostsOsImage, 'g2'), not(empty(steps('sessionHosts').sessionHostsOsSection.sessionHostsComputeGalleryImage))))]",
                            "label": "Security profile",
                            "elements": [
                                {
                                    "name": "sessionHostSecurityTypeWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[not(empty(steps('sessionHosts').sessionHostsOsSection.sessionHostsComputeGalleryImage))]",
                                    "options": {
                                        "text": "Setting the Security Type to anything other than 'Standard' requires that the Azure Compute Gallery Image Definition be configured with the Security Type feature set to the appropriate value. You can determine if the image definition supports the required feature by reviewing the 'Properties' tab on the 'Overview' node of the Gallery Image Definition in the portal. If the image definition does not contain these feature options, then the deployment will fail.",
                                        "uri": "https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/galleries/images?pivots=deployment-language-bicep",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "securityType",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Security type",
                                    "filter": true,
                                    "defaultValue": "Standard",
                                    "toolTip": "Choose a type of security that matches your needs: Standard includes basic protections at no additional cost. Trusted launch virtual machines provide additional security features on Gen2 virtual machines to protect against persistent and advanced attacks.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Standard",
                                                "value": "Standard"
                                            },
                                            {
                                                "label": "Trusted Launch Virtual Machines",
                                                "value": "TrustedLaunch"
                                            },
                                            {
                                                "label": "Confidential Virtual Machines",
                                                "value": "ConfidentialVM"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "secureBootEnabled",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[or(equals(steps('sessionHosts').sessionHostsSecuritySection.securityType, 'TrustedLaunch'), equals(steps('sessionHosts').sessionHostsSecuritySection.securityType, 'ConfidentialVM'))]",
                                    "label": "Enable secure boot",
                                    "defaultValue": "No",
                                    "toolTip": "Secure boot helps protect your VMs against boot kits, rootkits, and kernel-level malware.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "vTpmEnabled",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[or(equals(steps('sessionHosts').sessionHostsSecuritySection.securityType, 'TrustedLaunch'), equals(steps('sessionHosts').sessionHostsSecuritySection.securityType, 'ConfidentialVM'))]",
                                    "label": "Enable vTPM",
                                    "defaultValue": "No",
                                    "toolTip": "Virtual Trusted Platform Module (vTPM) is TPM2.0 compliant and validates your VM boot integrity apart from securely storing keys and secrets.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "network",
                    "label": "Network connectivity",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "virtualNetworklInfoBox",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                            "options": {
                                "text": "AVD landing zone accelerator requires connectivity to identity services (ADDS, AADDS or AAD).",
                                "uri": "https://docs.microsoft.com/azure/virtual-desktop/authentication",
                                "style": "info"
                            }
                        },
                        {
                            "name": "createAvdVirtualNetwork",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Virtual network",
                            "defaultValue": "New",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "New",
                                        "value": true
                                    },
                                    {
                                        "label": "Existing",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "virtualNetworkSize",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                            "label": "vNet address range",
                            "toolTip": "Virtual network for AVD virtual machines",
                            "placeholder": "Example: 10.10.0.0/23",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 10 to 24."
                            }
                        },
                        {
                            "name": "virtualNetworkSubnetSize",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                            "label": "Subnet address prefix",
                            "toolTip": "Virtual network subnet for AVD virtual machines",
                            "placeholder": "Example: 10.10.0.0/23",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 10 to 24."
                            }
                        },
                        {
                            "name": "virtualNetworkDns",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                            "label": "Custom DNS Servers",
                            "defaultValue": "",
                            "placeholder": "Example: 10.10.100.4,10.10.100.5",
                            "toolTip": "Enter multiple IPs separated by a comma, if not provided Azure provided DNS will be used. Azure default DNS server (168.63.129.16) will be added as a last resort.",
                            "constraints": {
                                "regex": ""
                            }
                        },
                        {
                            "name": "existingVirtualNetworkInfoBox",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, false)]",
                            "options": {
                                "text": "Existing network must has connectivity to identity and DNS services.",
                                "uri": "https://docs.microsoft.com/azure/architecture/example-scenario/wvd/windows-virtual-desktop?context=/azure/virtual-desktop/context/context",
                                "style": "info"
                            }
                        },
                        {
                            "name": "virtualNetworkSelectorId",
                            "type": "Microsoft.Solutions.ResourceSelector",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, false)]",
                            "label": "Virtual network",
                            "resourceType": "Microsoft.Network/virtualNetworks",
                            "constraints": {
                                "required": true
                            },
                            "options": {
                                "filter": {
                                    "subscription": "onBasics",
                                    "location": "[steps('SessionHosts').SessionHostsRegionSection.SessionHostsRegion.location.displayName]"
                                }
                            }
                        },
                        {
                            "name": "subnetApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "[concat(steps('network').virtualNetworkSelectorId.id, '/subnets?api-version=2021-03-01')]"
                            }
                        },
                        {
                            "name": "virtualNetworkSubnetSelectorName",
                            "label": "Subnet",
                            "type": "Microsoft.Common.DropDown",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, false)]",
                            "defaultValue": "",
                            "toolTip": "Select the subnet.",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": true,
                            "filterPlaceholder": "Filter items ...",
                            "multiLine": true,
                            "constraints": {
                                "allowedValues": "[map(steps('network').subnetApi.value,(item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\",\"description\":\"', 'Resource Group: ', last(take(split(item.id, '/'), 5)), '\"}')))]",
                                "required": true
                            }
                        },
                        {
                            "name": "existingVirtualNetworkInfoBoxPrivateEndpointWarning",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, false)]",
                            "options": {
                                "text": "Private endpoint network policy needs to be disabled on the existing subnet before deploying AVD accelerator.",
                                "uri": "https://docs.microsoft.com/azure/private-link/disable-private-endpoint-network-policy",
                                "style": "Warning"
                            }
                        },
                        {
                            "name": "virtualNetworkPrivateDnsZone",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Azure private DNS zone (Private endpoints)",
                            "defaultValue": "Yes",
                            "toolTip": "It is recommended to use Azure private DNS zones for private endpoint name spaces (ALZ recommended and deployed).",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "virtualNetworkPrivateDnsZoneSelection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('network').virtualNetworkPrivateDnsZone, true)]",
                            "elements": [
                                {
                                    "name": "virtualNetworkPrivateDnsZoneFilesSelector",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true)]",
                                    "label": "File share (privatelink.file.core.windows.net)",
                                    "resourceType": "Microsoft.Network/privateDnsZones",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "virtualNetworkPrivateDnsZoneKeyvaultSelector",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "label": "Key vault (privatelink.vaultcore.azure.net)",
                                    "resourceType": "Microsoft.Network/privateDnsZones",
                                    "constraints": {
                                        "required": true
                                    }
                                }
                            ]
                        },
                        {
                            "name": "virtualNetworkPeeringInfoBox",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                            "options": {
                                "text": "vNet peering will be created to existing vNet hub with access to identity and DNS services .",
                                "uri": "https://docs.microsoft.com/azure/architecture/example-scenario/wvd/windows-virtual-desktop?context=/azure/virtual-desktop/context/context",
                                "style": "info"
                            }
                        },
                        {
                            "name": "hubVirtualNetworkPeering",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                            "label": "Existing hub vNet peering information",
                            "elements": [
                                {
                                    "name": "hubVirtualNetworkPeeringInfoBox",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD')]",
                                    "options": {
                                        "text": "vNet peering to identity services is not required when joining VMs to Azure AD .",
                                        "uri": "https://learn.microsoft.com/en-us/azure/architecture/example-scenario/wvd/azure-virtual-desktop-azure-active-directory-join",
                                        "style": "info"
                                    }
                                },
                                {
                                    "name": "hubVirtualNetworkSubs",
                                    "type": "Microsoft.Solutions.ArmApiControl",
                                    "request": {
                                        "method": "GET",
                                        "path": "subscriptions?api-version=2020-01-01"
                                    }
                                },
                                {
                                    "name": "hubVirtualNetworkSub",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                                    "label": "Hub vNet Subscription",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": true,
                                    "filterPlaceholder": "Filter items ...",
                                    "multiLine": true,
                                    "constraints": {
                                        "allowedValues": "[map(steps('network').hubVirtualNetworkPeering.hubVirtualNetworkSubs.value, (sub) => parse(concat('{\"label\":\"', sub.displayName, '\",\"description\":\"', sub.subscriptionId, '\",\"value\":\"', toLower(sub.subscriptionId), '\"}')) )]",
                                        "required": true
                                    }
                                },
                                {
                                    "name": "existingHubVirtualNetworks",
                                    "type": "Microsoft.Solutions.ArmApiControl",
                                    "request": {
                                        "method": "GET",
                                        "path": "[concat('subscriptions/', steps('network').hubVirtualNetworkPeering.hubVirtualNetworkSub, '/providers/Microsoft.Network/virtualNetworks?api-version=2021-08-01')]"
                                    }
                                },
                                {
                                    "name": "existingHubVirtualNetwork",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                                    "label": "Hub vNet",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": true,
                                    "filter": true,
                                    "filterPlaceholder": "Filter items ...",
                                    "multiLine": true,
                                    "constraints": {
                                        "allowedValues": "[map(steps('network').hubVirtualNetworkPeering.existingHubVirtualNetworks.value, (vnet) => parse(concat('{\"label\":\"', vnet.name, '\",\"description\":\"', vnet.location, '\",\"value\":\"', toLower(vnet.id), '\"}')) )]",
                                        "required": true
                                    }
                                },
                                {
                                    "name": "hubVirtualNetworkGateway",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[not(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'))]",
                                    "label": "Gateway on hub",
                                    "defaultValue": "No",
                                    "toolTip": "This information will be used to set remote gateway settings on vNet peering.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "monitoring",
                    "label": "Monitoring",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "deployMonitoring",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy monitoring",
                            "defaultValue": "Yes (Recommended)",
                            "toolTip": "Deploy monitoring settings and if selected deploy Azure log analytics workspace.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes (Recommended)",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "deployMonitoringInfo1",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('monitoring').deployMonitoring, true)]",
                            "options": {
                                "text": "Azure Virtual Desktop monitoring requires an existing Azure Log Analytics Workspace or the creation of a new one.",
                                "uri": "https://docs.microsoft.com/azure/virtual-desktop/azure-monitor",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "deployMonitoringAlaWorkspace",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": "[equals(steps('monitoring').deployMonitoring, true)]",
                            "label": "Log analytics workspace",
                            "defaultValue": "New",
                            "toolTip": "Deploy monitoring settings and if selected deploy Azure log analytics workspace.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "New",
                                        "value": true
                                    },
                                    {
                                        "label": "Existing",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "deployMonitoringNewAlaWorkspaceRetention",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('monitoring').deployMonitoringAlaWorkspace, true)]", 
                            "label": "Retention policy (Days)",
                            "toolTip": "Number of days data will be retained in the workspace.",
                            "defaultValue": 90,
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z-]{1,90}$",
                                "validationMessage": "Value must be 1-90 characters."
                            }
                        },
                        {
                            "name": "alaWorkspaceExistingWorkspacesSelection",
                            "type": "Microsoft.Solutions.ResourceSelector",
                            "visible": "[equals(steps('monitoring').deployMonitoringAlaWorkspace, false)]", 
                            "label": "Existing workspace",
                            "resourceType": "Microsoft.OperationalInsights/workspaces",
                            "constraints": {
                                "required": true
                            }
                        },
                        {
                            "name": "deployMonitoringPolicies",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": "[equals(steps('monitoring').deployMonitoring, true)]",
                            "label": "Deploy monitoring policies (subscription level)",
                            "defaultValue": "No",
                            "toolTip": "Deploy monitoring policy and policy set definitions to set diagnostic settings on new deployed resources.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "deployMonitoringInfo2",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('monitoring').deployMonitoring, true)]",
                            "options": {
                                "text": "Deployment will configured all required settings to use the AVD insights workbook.",
                                "uri": "https://learn.microsoft.com/azure/virtual-desktop/azure-monitor?WT.mc_id=Portal-AppInsightsExtension",
                                "style": "Info"
                            }
                        }
                    ]
                },
                {
                    "name": "resourceNaming",
                    "label": "Resource naming",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "resourceNamingInfo1",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "The AVD accelerator provides automated resource naming based on Microsoft best practices, default resources organization and naming is shown in this diagram.",
                                "uri": "https://github.com/Azure/avdaccelerator/blob/main/workload/docs/diagrams/avd-accelerator-resource-organization-naming.png",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "resourceNamingSelection",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Custom resource naming",
                            "defaultValue": "No",
                            "toolTip": "When set 'Yes', the information provided will be used to name resources. When set to 'No' deployment will use the AVD accelerator naming standard.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "resourceNamingWarning",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('resourceNaming').resourceNamingSelection, true)]",
                            "options": {
                                "text": "When using custom naming for resources, please make sure to follow naming rules and restrictions for Azure resources.",
                                "uri": "https://docs.microsoft.com/azure/azure-resource-manager/management/resource-name-rules",
                                "style": "Warning"
                            }
                        },
                        {
                            "name": "resourceNamingAvdManagementPlane",
                            "type": "Microsoft.Common.Section",
                            "label": "AVD Management plane naming:",
                            "visible": "[equals(steps('resourceNaming').resourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "serviceObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "toolTip": "AVD management plane resources (Workspace, Host pool, Application groups, Key vault) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-service-objects",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "workSpaceCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workspace",
                                    "toolTip": "AVD workspace custom name.",
                                    "placeholder": "Example: vdws-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "workSpaceCustomFriendlyName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workspace (Friendly name)",
                                    "toolTip": "AVD workspace custom friendly name.",
                                    "placeholder": "Example: East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "hostPoolCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Host pool",
                                    "toolTip": "AVD host pool custom name.",
                                    "placeholder": "Example: vdpool-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "hostPoolCustomFriendlyName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Host pool (Friendly name)",
                                    "toolTip": "AVD host pool custom friendly name.",
                                    "placeholder": "Example: App1 - East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "scalingPlanCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Scaling Plan",
                                    "toolTip": "AVD host pool scaling plan.",
                                    "placeholder": "Example: vdscaling-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "applicationGroupCustomNameDesktop",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Desktop)",
                                    "toolTip": "AVD desktop application group custom name.",
                                    "placeholder": "Example: vdag-desktop-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "applicationGroupCustomFriendlyNameDesktop",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Desktop, Friendly name)",
                                    "toolTip": "AVD desktop application group custom name.",
                                    "placeholder": "Example: Desktops - App1 - East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "applicationGroupCustomNameRemoteApp",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Remote App)",
                                    "visible": "[equals(steps('managementPlane').managementPlaneAppGroupOptions.deployRemoteAppGroup, true)]",
                                    "toolTip": "AVD remote application group custom name.",
                                    "placeholder": "Example: vdag-rapp-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "applicationGroupCustomFriendlyNameRemoteApp",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Remote App, Friendly name)",
                                    "visible": "[equals(steps('managementPlane').managementPlaneAppGroupOptions.deployRemoteAppGroup, true)]",
                                    "toolTip": "AVD remote application group custom name.",
                                    "placeholder": "Example: Remote apps - App1 - East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "workloadKvCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Key vault prefix",
                                    "toolTip": "AVD keyvault prefix custom name.",
                                    "placeholder": "Example: kv-avd",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,6}$",
                                        "validationMessage": "Value must be 1-6 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "resourceNamingCompute",
                            "type": "Microsoft.Common.Section",
                            "label": "Compute naming:",
                            "visible": "[equals(steps('resourceNaming').resourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "computeObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "toolTip": "AVD compute resources (VMs, NICs, Disks, Availability sets) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-pool-compute",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "applicationSecurityGroupCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Applications security group",
                                    "toolTip": "AVD application security custom name.",
                                    "placeholder": "Example: asg-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                },
                                {
                                    "name": "sessionHostCustomNamePrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Session host prefix",
                                    "visible": "[equals(steps('sessionHosts').deploySessionHosts, true)]",
                                    "toolTip": "AVD session host prefix custom name.",
                                    "placeholder": "Example: vm-avd-app1",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,11}$",
                                        "validationMessage": "Value must be 1-11 characters."
                                    }
                                },
                                {
                                    "name": "availabilitySetCustomNamePrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Availability set prefix",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.sessionHostsAvailabilitySettings, false)]",
                                    "toolTip": "AVD availability set custom name.",
                                    "placeholder": "Example: avail-avd",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,9}$",
                                        "validationMessage": "Value must be 1-9 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "resourceNamingStorage",
                            "type": "Microsoft.Common.Section",
                            "label": "FSLogix storage naming:",
                            "visible": "[equals(steps('resourceNaming').resourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "resourceNamingStorageInfo1",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating storage (FSLogix) resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "resourceNamingStorageInfo2",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('sessionHosts').deploySessionHosts, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating storage (FSLogix) resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "storageObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true)]",
                                    "toolTip": "AVD storage resources (Storage account, file shares, files private endpoints, temporary domain join VM) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-storage",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "fslogixStorageCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Storage account prefix",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true)]",
                                    "toolTip": "AVD fslogix storage account prefix custom name.",
                                    "placeholder": "Example: stavd",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,5}$",
                                        "validationMessage": "Value must be 1-5 characters."
                                    }
                                },
                                {
                                    "name": "fslogixProfileContainerFileShareCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Profile container file share",
                                    "visible": "[equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true)]",
                                    "toolTip": "AVD fslogix storage account profile container file share prefix custom name.",
                                    "placeholder": "Example: fslogix-pc-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "resourceNamingNetwork",
                            "type": "Microsoft.Common.Section",
                            "label": "Network naming:",
                            "visible": "[equals(steps('resourceNaming').resourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "resourceNamingNetworkInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('network').createAvdVirtualNetwork, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating network resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "networkObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                                    "toolTip": "AVD network resources (vNet, NSG, Route table) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-network",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "virtualNetworkCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Virtual network",
                                    "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                                    "toolTip": "AVD virtual network custom name.",
                                    "placeholder": "Example: vnet-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "virtualNetworkSubnetCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Subnet",
                                    "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                                    "toolTip": "AVD virtual network subnet custom name.",
                                    "placeholder": "Example: snet-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                },
                                {
                                    "name": "networkSecurityGroupCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Network security group",
                                    "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                                    "toolTip": "AVD network security group custom name.",
                                    "placeholder": "Example: nsg-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                },
                                {
                                    "name": "routeTableCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Route table",
                                    "visible": "[equals(steps('network').createAvdVirtualNetwork, true)]",
                                    "toolTip": "AVD route table custom name.",
                                    "placeholder": "Example: route-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "resourceNamingMonitoring",
                            "type": "Microsoft.Common.Section",
                            "label": "Monitoring naming:",
                            "elements": [
                                {
                                    "name": "resourceNamingMonitoringInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('monitoring').deployMonitoring, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating monitoring resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "monitoringObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "visible": "[and(equals(steps('resourceNaming').resourceNamingSelection, true), equals(steps('monitoring').deployMonitoring, true))]",
                                    "toolTip": "AVD monitoring resources (log analytics workspace) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-monitoring",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "monitoringLogAnalyticsWorkspaceName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Log analytics workspace name",
                                    "visible": "[and(equals(steps('resourceNaming').resourceNamingSelection, true), equals(steps('monitoring').deployMonitoring, true), equals(steps('monitoring').deployMonitoringAlaWorkspace, true))]",
                                    "toolTip": "AVD monitoring log analytics workspace custom name.",
                                    "placeholder": "Example: log-avd-use2",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "resourceNamingInfo2",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "AVD accelerator has built-in resource naming automation based and best practices Microsoft Cloud Adoption Framework (CAF) naming convention.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "resourceNamingInfo3",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "And abbreviations recommendations for Azure resource types.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-abbreviations",
                                "style": "Info"
                            }
                        }
                    ]
                },
                {
                    "name": "resourceTagging",
                    "label": "Resource tagging",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "resourceTaggingSelection",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Create resource tags",
                            "defaultValue": "No",
                            "toolTip": "When set 'Yes', the information provided will be used to create tags on resources and resource groups.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
			    {
    				"name": "resourceTaggingParentCostInfo",
    				"type": "Microsoft.Common.InfoBox",
    				"options": {
        				"text": "By default, all resources will be tagged with parent resource cost management tag (cm-resource-parent). This will group all costs under the host pool resource.",
        				"uri": "https://learn.microsoft.com/azure/virtual-desktop/tag-virtual-desktop-resources#use-the-cm-resource-parent-tag-to-automatically-group-costs-by-host-pool",
        				"style": "Info"
    				}
			},
                        {
                            "name": "resourceTags",
                            "type": "Microsoft.Common.Section",
                            "label": "Resources tags:",
                            "visible": "[equals(steps('resourceTagging').resourceTaggingSelection, true)]",
                            "elements": [
                                {
                                    "name": "tagsWorkloadName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workload name:",
                                    "toolTip": "This input will be the value of a tag named WorkloadName.",
                                    "placeholder": "Example: Contoso-Workload",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "tagsWorkloadType",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Workload type:",
                                    "filter": true,
                                    "defaultValue": "Light",
                                    "toolTip": "This input will be the value of a tag named WorkloadType, reference to the size of the VM for your workloads.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Light",
                                                "description": "",
                                                "value": "Light"
                                            },
                                            {
                                                "label": "Medium",
                                                "description": "",
                                                "value": "Medium"
                                            },
                                            {
                                                "label": "High",
                                                "description": "",
                                                "value": "High"
                                            },
                                            {
                                                "label": "Power",
                                                "description": "",
                                                "value": "POwer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "tagsDataClassificationTag",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Data classification:",
                                    "filter": true,
                                    "defaultValue": "Non-business",
                                    "toolTip": "This input will be the value of a tag named DataClassification, reference to the sensitivity of data hosted.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Non-business",
                                                "description": "",
                                                "value": "Non-business"
                                            },
                                            {
                                                "label": "Public",
                                                "description": "",
                                                "value": "Public"
                                            },
                                            {
                                                "label": "General",
                                                "description": "",
                                                "value": "General"
                                            },
                                            {
                                                "label": "Confidential",
                                                "description": "",
                                                "value": "Confidential"
                                            },
                                            {
                                                "label": "Highly-confidential",
                                                "description": "",
                                                "value": "Highly-confidential"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "tagsDepartmentTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Department:",
                                    "toolTip": "This input will be the value of a tag named Department, reference the department that owns the deployment.",
                                    "placeholder": "Example: Contoso-AVD",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "tagsCriticalityTag",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Workload criticality:",
                                    "filter": true,
                                    "defaultValue": "Low",
                                    "toolTip": "This input will be the value of a tag named Criticality, reference to the criticality of the workload.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Low",
                                                "description": "",
                                                "value": "Low"
                                            },
                                            {
                                                "label": "Medium",
                                                "description": "",
                                                "value": "Medium"
                                            },
                                            {
                                                "label": "High",
                                                "description": "",
                                                "value": "High"
                                            },
                                            {
                                                "label": "Missin-critical",
                                                "description": "",
                                                "value": "Missin-critical"
                                            },
                                            {
                                                "label": "Custom",
                                                "description": "",
                                                "value": "Custom"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "tagsCustomWorkloadCriticality",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Custom workload criticality:",
                                    "visible": "[equals(steps('resourceTagging').resourceTags.tagsCriticalityTag, 'Custom')]",
                                    "toolTip": "This input will be the value of a tag named Criticality, reference to a custom criticality for the workload.",
                                    "placeholder": "Example: Contoso-Criticality",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "tagsApplicationNameTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application name:",
                                    "toolTip": "This input will be the value of a tag named ApplicationName, reference details about the application.",
                                    "placeholder": "Example: Contoso-App",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "tagsWorkloadSlaTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workload SLA:",
                                    "toolTip": "This input will be the value of a tag named ServiceClass, reference to the service level agreement level of the worload.",
                                    "placeholder": "Example: Contoso-SLA",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "tagsOpsTeamTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Operations team:",
                                    "toolTip": "This input will be the value of a tag named OpsTeam, reference to the team accountable for day-to-day operations.",
                                    "placeholder": "Example: workload-admins@Contoso.com",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "tagsOwnerTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Owner:",
                                    "toolTip": "This input will be the value of a tag named Owner, reference to the organizational owner of the AVD deployment.",
                                    "placeholder": "Example: workload-owner@Contoso.com",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "tagsCostCenterTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Cost center:",
                                    "toolTip": "This input will be the value of a tag named CostCenter, reference to the cost center of owner team.",
                                    "placeholder": "Example: Contoso-CC",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "tagsEnvironmentTypeTag",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Environment type:",
                                    "filter": true,
                                    "defaultValue": "Dev",
                                    "toolTip": "This input will be the value of a tag named Environment, reference to the environment type of the workload.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Dev",
                                                "description": "",
                                                "value": "Dev"
                                            },
                                            {
                                                "label": "Staging",
                                                "description": "",
                                                "value": "Staging"
                                            },
                                            {
                                                "label": "Prod",
                                                "description": "",
                                                "value": "Prod"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        "outputs": {
            "parameters": {
                "deploymentPrefix": "[steps('basics').deploymentPrefix]",
                "avdManagementPlaneLocation": "[steps('basics').resourceScope.location.name]",
                "avdSessionHostLocation": "[steps('sessionHosts').sessionHostsRegionSection.sessionHostsRegion.name]",
                "avdWorkloadSubsId": "[steps('basics').resourceScope.subscription.subscriptionId]",
                "avdHostPoolType": "[steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType]",
                "avdHostPoolLoadBalancerType": "[steps('managementPlane').managementPlaneHostPoolSettings.loadBalancerType]",
                "avhHostPoolMaxSessions": "[if(equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled'), steps('managementPlane').managementPlaneHostPoolSettings.maxSessions, 1)]",
                "avdPersonalAssignType": "[if(equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Personal'), steps('managementPlane').managementPlaneHostPoolSettings.assignmentType, 'Automatic')]",
                "avdDeployRappGroup": "[if(equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled'), steps('managementPlane').managementPlaneAppGroupOptions.deployRemoteAppGroup, false)]",
                "avdIdentityServiceProvider": "[steps('identity').identityDomainInformation.identityServiceProvider]",
                "createIntuneEnrollment": "[if(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'), steps('identity').identityDomainInformation.identityServiceProviderIntuneEnrollment, false)]",
                "avdIdentityDomainName": "[if(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'), 'none', steps('identity').identityDomainInformation.identityDomainName)]",
                "avdOuPath": "[if(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'), 'none', steps('sessionHosts').sessionHostsComputeStorageSection.identityDomainOuPath)]",
                "avdDomainJoinUserName": "[if(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'), 'none', steps('identity').identityDomainCredentials.identityDomainJoinUserName)]",
                "avdDomainJoinUserPassword": "[if(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'), 'none', steps('identity').identityDomainCredentials.identityDomainJoinUserPassword)]",
                "avdVmLocalUserName": "[steps('identity').identityLocalCredentials.identityLocalUserName]",
                "avdVmLocalUserPassword": "[steps('identity').identityLocalCredentials.identityLocalUserPassword.password]",
                "createAvdVnet": "[steps('network').createAvdVirtualNetwork]",
                "avdVnetworkAddressPrefixes": "[if(equals(steps('network').createAvdVirtualNetwork, true), steps('network').virtualNetworkSize, '10.10.0.0/23')]",
                "avdVnetworkSubnetAddressPrefix": "[if(equals(steps('network').createAvdVirtualNetwork, true), steps('network').virtualNetworkSubnetSize, '10.10.0.0/23')]",
                "customDnsIps": "[if(equals(steps('network').createAvdVirtualNetwork, true), steps('network').virtualNetworkDns, 'none')]",
                "existingHubVnetResourceId": "[if(equals(steps('network').createAvdVirtualNetwork, true), steps('network').hubVirtualNetworkPeering.existingHubVirtualNetwork, '')]",
                "vNetworkGatewayOnHub": "[if(equals(steps('network').createAvdVirtualNetwork, true), steps('network').hubVirtualNetworkPeering.hubVirtualNetworkGateway, false)]",
                "existingVnetSubnetResourceId": "[if(equals(steps('network').createAvdVirtualNetwork, false), steps('network').virtualNetworkSubnetSelectorName, 'none')]",
                "avdDeploySessionHosts": "[steps('sessionHosts').deploySessionHosts]",
                "avdStartVmOnConnect": "[if(equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Personal'), steps('managementPlane').managementPlaneHostPoolScaling.startVmOnConnect, false)]",
                "avdDeployScalingPlan": "[if(equals(steps('managementPlane').managementPlaneHostPoolSettings.hostPoolType, 'Pooled'), steps('managementPlane').managementPlaneHostPoolScaling.scalingPlan, false)]",
                "createStartVmOnConnectCustomRole": "[if(equals(steps('managementPlane').managementPlaneHostPoolScaling.startVmOnConnect, true), steps('managementPlane').managementPlaneHostPoolScaling.createVmRole, false)]",
                "avdEnterpriseAppObjectId": "[if(or(equals(steps('managementPlane').managementPlaneHostPoolScaling.scalingPlan, true), equals(steps('managementPlane').managementPlaneHostPoolScaling.startVmOnConnect, true)), steps('managementPlane').managementPlaneHostPoolScaling.avdEnterpriseApplication.objectId, 'none')]",
                "avdUseAvailabilityZones": "[steps('sessionHosts').sessionHostsComputeStorageSection.sessionHostsAvailabilitySettings]",
                "avdDeploySessionHostsCount": "[if(equals(steps('sessionHosts').deploySessionHosts, true), steps('sessionHosts').sessionHostsSettingsSection.sessionHostsCount, 1)]",
                "useSharedImage": "[if(equals(steps('sessionHosts').deploySessionHosts, true), steps('sessionHosts').sessionHostsOsSection.sessionHostsImageSource, false)]",
                "avdOsImage": "[if(equals(steps('sessionHosts').sessionHostsOsSection.sessionHostsImageSource, false), steps('sessionHosts').sessionHostsOsSection.sessionHostsOsImage, 'win11_21h2')]",
                "securityType": "[steps('sessionHosts').sessionHostsSecuritySection.securityType]",
                "secureBootEnabled": "[steps('sessionHosts').sessionHostsSecuritySection.secureBootEnabled]",
                "vTpmEnabled": "[steps('sessionHosts').sessionHostsSecuritySection.vTpmEnabled]",
                "avdImageTemplateDefinitionId": "[if(equals(steps('sessionHosts').sessionHostsOsSection.sessionHostsImageSource, true), steps('sessionHosts').sessionHostsOsSection.sessionHostsComputeGalleryImage.id, 'none')]",
                "avdSessionHostDiskType": "[steps('sessionHosts').sessionHostsSettingsSection.sessionHostDiskType]",
                "avdSessionHostsSize": "[if(equals(steps('sessionHosts').deploySessionHosts, true), steps('sessionHosts').sessionHostsSettingsSection.sessionHostSize, 'Standard_D2s_v4')]",
                "avdVnetPrivateDnsZone": "[steps('network').virtualNetworkPrivateDnsZone]",
                "avdVnetPrivateDnsZoneFilesId": "[if(equals(steps('network').virtualNetworkPrivateDnsZone, true), steps('network').virtualNetworkPrivateDnsZoneSelection.virtualNetworkPrivateDnsZoneFilesSelector.id, '')]",
                "avdVnetPrivateDnsZoneKeyvaultId": "[if(equals(steps('network').virtualNetworkPrivateDnsZone, true), steps('network').virtualNetworkPrivateDnsZoneSelection.virtualNetworkPrivateDnsZoneKeyvaultSelector.id, '')]",
                "createAvdFslogixDeployment": "[if(equals(steps('identity').identityDomainInformation.identityServiceProvider, 'AAD'), false, steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment)]",
                "fslogixStorageSku": "[if(equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true), steps('sessionHosts').sessionHostsComputeStorageSection.storageAccountSku, 'Standard_LRS')]",
                "avdFslogixFileShareQuotaSize": "[if(equals(steps('sessionHosts').sessionHostsComputeStorageSection.fslogixDeployment, true), steps('sessionHosts').sessionHostsComputeStorageSection.sessionHostsFslogixFileShareQuota, 1 )]",
                "storageOuPath": "[steps('sessionHosts').sessionHostsComputeStorageSection.identityDomainOuPathStorageExisting]",
                "avdUseCustomNaming": "[steps('resourceNaming').resourceNamingSelection]",
                "avdServiceObjectsRgCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.serviceObjectsRgCustomName, 'none')]",
                "avdNetworkObjectsRgCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingNetwork.networkObjectsRgCustomName, 'none')]",
                "avdComputeObjectsRgCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingCompute.computeObjectsRgCustomName, 'none')]",
                "avdStorageObjectsRgCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingStorage.storageObjectsRgCustomName, 'none')]",
                "avdVnetworkCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingNetwork.virtualNetworkCustomName, 'none')]",
                "avdVnetworkSubnetCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingNetwork.virtualNetworkSubnetCustomName, 'none')]",
                "avdNetworksecurityGroupCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingNetwork.networkSecurityGroupCustomName, 'none')]",
                "avdRouteTableCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingNetwork.routeTableCustomName, 'none')]",
                "avdApplicationSecurityGroupCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingCompute.applicationSecurityGroupCustomName, 'none')]",
                "avdWorkSpaceCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.workSpaceCustomName, 'none')]",
                "avdWorkSpaceCustomFriendlyName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.workSpaceCustomFriendlyName, 'none')]",
                "avdHostPoolCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.hostPoolCustomName, 'none')]",
                "avdHostPoolCustomFriendlyName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.hostPoolCustomFriendlyName, 'none')]",
                "avdScalingPlanCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.scalingPlanCustomName, 'none')]",
                "avdApplicationGroupCustomNameDesktop": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.applicationGroupCustomNameDesktop, 'none')]",
                "avdApplicationGroupCustomFriendlyName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.applicationGroupCustomFriendlyNameDesktop, 'none')]",
                "avdApplicationGroupCustomNameRapp": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.applicationGroupCustomNameRemoteApp, 'none')]",
                "avdApplicationGroupCustomFriendlyNameRapp": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.applicationGroupCustomFriendlyNameRemoteApp, 'none')]",
                "avdSessionHostCustomNamePrefix": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingCompute.sessionHostCustomNamePrefix, 'none')]",
                "avdAvailabilitySetCustomNamePrefix": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingCompute.availabilitySetCustomNamePrefix, 'none')]",
                "avdFslogixStoragePrefixCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingStorage.fslogixStorageCustomName, 'none')]",
                "avdFslogixProfileContainerFileShareCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingStorage.fslogixProfileContainerFileShareCustomName, 'none')]",
                "avdWrklKvPrefixCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingAvdManagementPlane.workloadKvCustomName, 'none')]",
                "createResourceTags": "[steps('resourceTagging').resourceTaggingSelection]",
                "workloadNameTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsWorkloadName, 'none')]",
                "workloadTypeTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsWorkloadType, 'Light')]",
                "dataClassificationTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsDataClassificationTag, 'Non-business')]",
                "departmentTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsDepartmentTag, 'none')]",
                "workloadCriticalityTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsCriticalityTag, 'Low')]",
                "workloadCriticalityCustomValueTag": "[if(equals(steps('resourceTagging').resourceTags.tagsCriticalityTag, 'Custom'), steps('resourceTagging').resourceTags.tagsCustomWorkloadCriticality, 'Low')]",
                "applicationNameTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsApplicationNameTag, 'none')]",
                "workloadSlaTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsWorkloadSlaTag, 'none')]",
                "opsTeamTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsOpsTeamTag, 'none')]",
                "ownerTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsOwnerTag, 'none')]",
                "costCenterTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsCostCenterTag, 'none')]",
                "environmentTypeTag": "[if(equals(steps('resourceTagging').resourceTaggingSelection, true), steps('resourceTagging').resourceTags.tagsEnvironmentTypeTag, 'Dev')]",
                "avdApplicationGroupIdentityType": "[steps('identity').identityAvdUserAccess.identityAccessTypes]",
                "avdApplicationGroupIdentitiesIds": "[steps('identity').identityAvdUserAccess.identityAccessIds]",
                "avdDeployMonitoring": "[steps('monitoring').deployMonitoring]",
                "deployAlaWorkspace": "[if(equals(steps('monitoring').deployMonitoring, true), steps('monitoring').deployMonitoringAlaWorkspace, false)]",
                "avdAlaWorkspaceDataRetention": "[if(equals(steps('monitoring').deployMonitoringAlaWorkspace, true), steps('monitoring').deployMonitoringNewAlaWorkspaceRetention, 0)]",
                "alaExistingWorkspaceResourceId": "[if(equals(steps('monitoring').deployMonitoringAlaWorkspace, false), steps('monitoring').alaWorkspaceExistingWorkspacesSelection.id, 'none')]",
                "deployCustomPolicyMonitoring": "[if(equals(steps('monitoring').deployMonitoring, true), steps('monitoring').deployMonitoringPolicies, false)]",
                "avdMonitoringRgCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingMonitoring.monitoringObjectsRgCustomName, 'none')]",
                "avdAlaWorkspaceCustomName": "[if(equals(steps('resourceNaming').resourceNamingSelection, true), steps('resourceNaming').resourceNamingMonitoring.monitoringLogAnalyticsWorkspaceName, 'none')]"
            },
            "kind": "Subscription",
            "location": "[steps('basics').resourceScope.location.name]",
            "subscriptionId": "[steps('basics').resourceScope.subscription.id]"
        }
    }
}
