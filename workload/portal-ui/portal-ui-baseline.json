{
    "$schema": "<relative path to createFormUI.schema.json>",
    "view": {
        "kind": "Form",
        "properties": {
            "isWizard": false,
            "title": "AVD Landing Zone Accelerator - Baseline",
            "steps": [
                {
                    "name": "basics",
                    "label": "Deployment Basics",
                    "elements": [
                        {
                            "name": "DeploymentInfo",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Important Information",
                            "elements": [
                                {
                                    "name": "infoPreReq",
                                    "type": "Microsoft.Common.InfoBox",
                                    "options": {
                                        "text": "PREREQUISITES REQUIRED \n\nThere are prerequisites that must be setup in your Azure environment to successfully deploy this AVD Landing Zone Accelerator. Click here to review the prerequisites in the Getting Started guide.",
                                        "uri": "https://github.com/Azure/avdaccelerator/blob/main/workload/docs/getting-started-baseline.md",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "info",
                                    "type": "Microsoft.Common.InfoBox",
                                    "options": {
										"style": "Info",
                                        "text": "The subscription selected in the 'Project details' section below will be used to deploy all resources. \n\nThe region selected in 'Instance details' section below will be used to deploy the AVD management plane resources (workspace, host pool, and application group, etc.). These resource types are not available in all regions, but they are globally replicated.\n\nThe session hosts do not have to be deployed to the same region, therefore you will have the option to select that region on the 'Session Hosts' blade.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/data-locations"										
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ResourceScope",
                            "type": "Microsoft.Common.ResourceScope",
                            "location": {
                                "resourceTypes": [
                                    "Microsoft.DesktopVirtualization/workspaces"
                                ]
                            }
                        },
                        {
                            "name": "infoResourceGroupNaming",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Azure AVD Landing Zones will create the resource group hierarchy under the subscriptions with the prefix provided in this step.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-group-and-subscription-organization"
                                }
                            }
                        },
                        {
                            "name": "DeploymentPrefix",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Deployment prefix",
                            "toolTip": "Provide a prefix (max 4 characters) for the resource groups and resources created as part of AVD landing zones.",
                            "placeholder": "Example: app1",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z-]{1,4}$",
                                "validationMessage": "The prefix must be 1-4 characters."
                            }
                        }
                    ]
                },
                {
                    "name": "Identity",
                    "label": "Identity",
                    "elements": [
                        {
                            "name": "identityInfo",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "AVD landing zone accelerator deployment expects identity service to be already available in the current Azure estate.",
                                "uri": "https://docs.microsoft.com/azure/virtual-desktop/authentication#identities",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "IdentityDomainInformation",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Domain to join",
                            "elements": [
                                {
                                    "name": "IdentityServiceProvider",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": true,
                                    "label": "Identity service provider",
                                    "defaultValue": "Active Directory (AD DS)",
                                    "toolTip": "Identity service provider (ADDS or AADDS) that already exist and will be used for Azure Virtual Desktop.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Azure Active Directory (AAD)",
                                                "value": "AAD"
                                            },
                                            {
                                                "label": "Active Directory (AD DS)",
                                                "value": "ADDS"
                                            },
                                            {
                                                "label": "Azure AD Domain Services (AAD DS)",
                                                "value": "AADDS"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "IdentityServiceProviderIntuneEnrollment",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD')]",
                                    "label": "Enroll VM with Intune",
                                    "defaultValue": "No",
                                    "toolTip": "If Intune is configured in your Azure AD tenant, you can choose to have the VM automatically enrolled during the deployment by selecting Yes.",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "IdentityDomainName",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "label": "Domain name",
                                    "toolTip": "Provide identity service domain name.",
                                    "placeholder": "Example: contoso.com",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "IdentityServiceProviderInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "options": {
                                        "text": "Identity service provider must already exist, as they are a prerequisite for the AVD LZA deployment.",
                                        "uri": "https://github.com/Azure/avdaccelerator/blob/main/workload/docs/getting-started.md",
                                        "style": "Info"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "IdentityAvdUserAccess",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "AVD users' role assignment",
                            "elements": [
                                {
                                    "name": "IdentityAccessTypes",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": true,
                                    "label": "Identity type",
                                    "defaultValue": "Groups",
                                    "toolTip": "Select the type of identities that will be entered in the 'Identities ObjectIDs' field.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Groups",
                                                "value": "Group"
                                            },
                                            {
                                                "label": "Users",
                                                "value": "User"
                                            },
                                            {
                                                "label": "Service Principals",
                                                "value": "ServicePrincipal"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "IdentityAccessIds",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Identities ObjectIDs",
                                    "toolTip": "Comma separated list of identities (ObjectIDs) to be granted access to AVD published items and to create sessions on VMs and single sign-on (SSO) when using AAD as identity provider.",
                                    "placeholder": "Example: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX,XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
                                }

                            ]
                        },
                        {
                            "name": "IdentityDomainCredentials",
                            "type": "Microsoft.Common.Section",
                            "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                            "label": "Domain join credentials",
                            "elements": [
                                {
                                    "name": "IdentityDomainJoinUserName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Username",
                                    "toolTip": "Provide username with permissions to join session host to the domain.",
                                    "placeholder": "Example: avdadmin@contoso.com",
                                    "defaultValue": "",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "IdentityDomainJoinUserPassword",
                                    "type": "Microsoft.Common.PasswordBox",
                                    "label": {
                                        "password": "Password"
                                    },
                                    "toolTip": "Provide password for domain join account.",
                                    "constraints": {
                                        "required": true
                                    },
                                    "options": {
                                        "hideConfirmation": false
                                    }
                                }
                            ]
                        },
                        {
                            "name": "IdentityLocalCredentials",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Session host local admin credentials",
                            "elements": [
                                {
                                    "name": "IdentityLocalUserName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Username",
                                    "toolTip": "Provide username for session host local admin account.",
                                    "placeholder": "Example: avdadmin",
                                    "defaultValue": "",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "IdentityLocalUserPassword",
                                    "type": "Microsoft.Compute.CredentialsCombo",
                                    "visible": true,
                                    "label": {
                                        "password": "Password",
                                        "confirmPassword": "Confirm password"
                                    },
                                    "toolTip": {
                                        "password": "The password must be alphanumeric, contain at least 12 characters, have at least 1 letter,1 number and 1 special character."
                                    },
                                    "constraints": {
                                        "required": true
                                    },
                                    "options": {
                                        "hideConfirmation": false
                                    },
                                    "osPlatform": "Windows"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "ManagementPlane",
                    "label": "Management plane",
                    "elements": [
                        {
                            "name": "ManagementPlaneHostPoolSettings",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Host pool settings",
                            "elements": [
                                {
                                    "name": "hostPoolType",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": true,
                                    "label": "Host pool type",
                                    "defaultValue": "Pooled",
                                    "multiLine": true,
                                    "toolTip": "",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Pooled",
                                                "description": "",
                                                "value": "Pooled"
                                            },
                                            {
                                                "label": "Personal",
                                                "description": "",
                                                "value": "Personal"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "subWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "icon": "Warning",
                                        "text": "Host pool type can not be changed after deployment.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/environment-setup"
                                    }
                                },
                                {
                                    "name": "loadBalancerType",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "label": "Load balancing algorithm",
                                    "defaultValue": "BreadthFirst",
                                    "multiLine": true,
                                    "toolTip": "Breadth-first load balancing distributes new user sessions across all available session hosts in the host pool. Depth-first load balancing distributes new user sessions to an available session host with the highest number of connections but has not reached its maximum session limit threshold.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "BreadthFirst",
                                                "description": "Each new user is placed on the next VM. (Performance Optimized)",
                                                "value": "BreadthFirst"
                                            },
                                            {
                                                "label": "DepthFirst",
                                                "description": "Each new user is placed on the same VM until max sessions limit. (Cost Optimized)",
                                                "value": "DepthFirst"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "maxSessions",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "label": "Max session limit",
                                    "defaultValue": "5",
                                    "toolTip": "The maximum number of users that have concurrent sessions on a session host. When setting a host pool to have depth first load balancing or planning to use Autoscaling, you must set an appropriate max session limit according to the configuration of your deployment and capacity of your VMs.",
                                    "constraints": {
                                        "required": false,
                                        "regex": "",
                                        "validationMessage": ""
                                    }
                                },
                                {
                                    "name": "assignmentType",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Personal')]",
                                    "label": "Machine assignment",
                                    "defaultValue": "Automatic (Recommended)",
                                    "multiLine": true,
                                    "toolTip": "Automatic assignment – The service will select an available host and assign it to an user. Direct assignment – Admin selects a specific host to assign to an user.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Automatic (Recommended)",
                                                "description": "Users are assigned an available VM the first time they connect.",
                                                "value": "Automatic"
                                            },
                                            {
                                                "label": "Direct",
                                                "description": "An administrator assigns a VM for each individual user.",
                                                "value": "Direct"
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ManagementPlaneAppGroupOptions",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                            "label": "Application group options (Desktop application group will be deployed by default)",
                            "elements": [
                                {
                                    "name": "DeployRappGroup",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": true,
                                    "label": "Create remote app group",
                                    "defaultValue": "Yes (Recommended)",
                                    "toolTip": "This application group type allows to publish seamless apps instead of full desktops.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Recommended)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ManagementPlaneHostPoolScaling",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Session host scaling options",
                            "elements": [
                                {
                                    "name": "ScalingPlan",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "label": "AVD scaling plan",
                                    "defaultValue": "Yes (Recommended)",
                                    "toolTip": "Will automatically manage session host power state based on usage and schedules (weekdays and weekend schedules will be created). ",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Recommended)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "startVmOnConnect",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Personal')]",
                                    "label": "Start VM on connect",
                                    "defaultValue": "Yes (Recommended)",
                                    "toolTip": "If powered off, start VM once user connects. ",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Recommended)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "createVmRole",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolScaling.startVmOnConnect, true)]",
                                    "label": "Create start VM on connect role",
                                    "defaultValue": "Yes (Required if using Start VM On Connect)",
                                    "toolTip": "Create custom Azure IAM role for Start VM on Connect",
                                    "constraints": {
                                        "required": false,
                                        "allowedValues": [
                                            {
                                                "label": "Yes (Required if using Start VM On Connect)",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "EnterApplication",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": true,
                                    "label": "AVD enterprise application ObjectID",
                                    "defaultValue": "",
                                    "toolTip": "Provide the ObjectID of the enterprise application Azure Virtual Desktop (Name can also be displayed as 'Windows Virtual Desktops'). To get the ObjectID got to Azure AD > Enterprise applications, remove all filters and search for 'Virtual Desktops' and copy the OjectID that is paired with the Application ID: 9cdead84-a844-4324-93f2-b2e6bb768d07.",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "ScalingPlanInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled')]",
                                    "options": {
                                        "text": "Session hosts can be excluded from the scaling plan by assigning the tag name Exclude-avdScalingPlanName, if not using custom resource naming and example of default tag name is Exclude-vdscaling-eus2-app1-001.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/autoscale-scenarios#scenario-4-how-do-exclusion-tags-work",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "vmRoleWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneHostPoolScaling.createVmRole, false)]",
                                    "options": {
                                        "text": "Start VM on Connect will not work without a custom role definition. If you enable start on connect, but do not specify a custom role VM's will not start on-demand. Only select no if this custom role already exists and is assigned to your AVD subscription.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-desktop/start-virtual-machine-connect",
                                        "style": "Warning"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "SessionHosts",
                    "label": "Session hosts",
                    "elements": [
                        {
                            "name": "DeploySessionHosts",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy session hosts",
                            "defaultValue": "Yes",
                            "toolTip": "Create session hosts compute and storage resources.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "SessionHostsRegionSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('SessionHosts').DeploySessionHosts, true)]",
                            "label": "Region Settings",
                            "tooltip": "The section allows you to specify the region where the compute, storage, and key vault resources are deployed.",
                            "elements": [
                                {
                                    "name": "SessionHostsRegion",
                                    "type": "Microsoft.Common.LocationSelector",
                                    "label": "Session Hosts Region",
                                    "defaultValue": "[steps('basics').ResourceScope.location.displayName]",
                                    "toolTip": "Select the region where the session hosts and required resources are to be deployed.",
                                    "resourceTypes": [
                                        "Microsoft.Compute/virtualMachines"
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "SessionHostsComputeStorageSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('SessionHosts').DeploySessionHosts, true)]",
                            "label": "General settings",
                            "tooltip": "This settings apply to compute, storage, image management and key vault resources.",
                            "elements": [
                                {
                                    "name": "IdentityDomainOuPath",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "label": "Session hosts OU path (Optional)",
                                    "toolTip": "Provide OU where to locate session hosts, if not provided session hosts will be placed on the default (computers) OU.",
                                    "placeholder": "Example: OU=session-hosts,OU=avd,DC=contoso,DC=com",
                                    "constraints": {}
                                },
                                { 
                                    "name": "SessionHostsAvailabilitySettings",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Use availability zones",
                                    "defaultValue": "No",
                                    "toolTip": "Distribute compute resources across availability zones. If 'No' is selected then an availability set will be created to host the VMs.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "FslogixDeploymentDisabledAad",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD')]",
                                    "options": {
                                        "text": "FSLogix for Azure AD joined session hosts is currently not globally available (GA).",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "FslogixDeployment",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "label": "Use FSLogix profile management",
                                    "defaultValue": "Yes",
                                    "toolTip": "Deploys FSLogix containers and session host setup for user's profiles.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "IdentityDomainOuPathBool",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "label": "Create OU for storage (fslogix)",
                                    "defaultValue": "No",
                                    "toolTip": "It is recommended to create a new AD Organizational Unit (OU) in AD and disable password expiration policy on computer accounts or service logon accounts accordingly.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
								{
                                    "name": "IdentityDomainOuPathStorage",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.IdentityDomainOuPathBool, true)]",
                                    "label": "New storage OU name",
                                    "toolTip": "OU will be created and used to locate storage account file share.",
                                    "placeholder": "Example: avdstorage",
                                    "constraints": {
                                        "required": true
                                    }
                                },	
                                {
                                    "name": "IdentityDomainOuPathStorageExisting",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.IdentityDomainOuPathBool, false)]",
                                    "label": "Existing storage OU path (Optional)",
                                    "toolTip": "Provide OU where to locate storage account file share, if not provided session hosts will be placed on the default (computers) OU.",
                                    "placeholder": "Example: OU=storage,OU=avd,DC=contoso,DC=com",
                                    "constraints": {}
                                },
                                {
                                    "name": "StorageAccountSku",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals (steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true)]",
                                    "label": "File share sku",
                                    "filter": true,
                                    "defaultValue": "Premium_LRS",
                                    "toolTip": "Storage account SKU for FSLogix storage. Recommended tier is Premium_ZRS when avaiable otherwise Premium_LRS.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Premium_LRS",
                                                "description": "",
                                                "value": "Premium_LRS"
                                            },
                                            {
                                                "label": "Premium_ZRS (When available)",
                                                "description": "",
                                                "value": "Premium_ZRS"
                                            },
                                            {
                                                "label": "Standard_LRS",
                                                "description": "",
                                                "value": "Standard_LRS"
                                            },
                                            {
                                                "label": "Standard_ZRS (When available)",
                                                "description": "",
                                                "value": "Standard_ZRS"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "SessionHostsFslogixFileShareQuota",
                                    "type": "Microsoft.Common.Slider",
                                    "visible": "[equals (steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true)]",
                                    "label": "File share size",
                                    "subLabel": "x 100GB",
                                    "toolTip": "Size of Azure File share quota, the maximum sizes are 5TB for standard SKU and 100TB for premium SKU",
                                    "min": 1,
                                    "max": 100,
                                    "defaultValue": 1,
                                    "showStepMarkers": true,
                                    "constraints": {
                                        "required": true
                                    }
                                }
                            ]
                        },
                        {
                            "name": "SessionHostsSettingsSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('SessionHosts').DeploySessionHosts, true)]",
                            "label": "Session hosts settings",
                            "elements": [
                                {
                                    "name": "element1",
                                    "type": "Microsoft.Compute.SizeSelector",
                                    "label": "VM Size",
                                    "toolTip": "",
                                    "recommendedSizes": [
                                        "Standard_D2s_v3"
                                    ],
                                    "constraints": {
                                        "allowedSizes": [],
                                        "excludedSizes": [],
                                        "required": true
                                    },
                                    "options": {
                                        "hideDiskTypeFilter": true
                                    },
                                    "osPlatform": "Windows",
                                    "imageReference": {
                                        "publisher": "MicrosoftWindowsDesktop",
                                        "offer": "Windows-11",
                                        "sku": "21h2-avd"
                                    }
                                },
                                {
                                    "name": "SessionHostsCount",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "VM count",
                                    "toolTip": "Provide the number of session hosts to deploy (1-49).",
                                    "defaultValue": 1,
                                    "constraints": {
                                        "required": true,
                                        "regex": "^([1-9]|[1-4][0-9])$",
                                        "validationMessage": "The count must be between 1-49 session hosts."
                                    }
                                },
                                {
                                    "name": "SessionHostDiskType",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "OS Disk type",
                                    "filter": true,
                                    "defaultValue": "Standard",
                                    "toolTip": "Select session host disk type to host the OS.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Standard",
                                                "value": "Standard_LRS"
                                            },
                                            {
                                                "label": "Premium",
                                                "value": "Premium_LRS"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "SessionHostEncryptionAtHostWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsSettingsSection.SessionHostEncryptionAtHost, true)]",
                                    "options": {
                                        "text": "Encryption at host requires feature EncryptionAtHost of resource provider Microsoft.Compute to be registered in the subscription.",
                                        "uri": "https://docs.microsoft.com/azure/virtual-machines/disks-enable-host-based-encryption-portal?msclkid=31c2d29bbce111ec8bca8257221ab9d1",
                                        "style": "Warning"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "SessionHostsOsSection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('SessionHosts').DeploySessionHosts, true)]",
                            "label": "OS selection",
                            "elements": [
                                {
                                    "name": "SessionHostsImageSource",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "OS image source",
                                    "filter": true,
                                    "defaultValue": "Marketplace",
                                    "toolTip": "Select marketplace or build custom image to deploy the session hosts.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Marketplace",
                                                "value": false
                                            },
                                            {
                                                "label": "Compute Gallery",
                                                "value": true
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "SessionHostsOsImage",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsOsSection.SessionHostsImageSource, false)]",
                                    "label": "OS version",
                                    "filter": true,
                                    "defaultValue": "Windows 11 22H2 (Gen2)",
                                    "toolTip": "Select the operating system version of the session hosts.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Windows 10 21H2",
                                                "value": "win10_21h2"
                                            },
                                            {
                                                "label": "Windows 10 21H2 - Office 365",
                                                "value": "win10_21h2_office"
                                            },
                                            {
                                                "label": "Windows 10 22H2 (Gen2)",
                                                "value": "win10_22h2_g2"
                                            },
                                            {
                                                "label": "Windows 10 22H2 - Office 365 (Gen2)",
                                                "value": "win10_22h2_office_g2"
                                            },
                                            {
                                                "label": "Windows 11",
                                                "value": "win11_21h2"
                                            },
                                            {
                                                "label": "Windows 11 - Office 365",
                                                "value": "win11_21h2_office"
                                            },
                                            {
                                                "label": "Windows 11 22H2 (Gen2)",
                                                "value": "win11_22h2"
                                            },
                                            {
                                                "label": "Windows 11 22H2 - Office 365 (Gen2)",
                                                "value": "win11_22h2_office"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "SessionHostsComputeGalleryImage",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsOsSection.SessionHostsImageSource, true)]",
                                    "label": "Image",
                                    "resourceType": "Microsoft.Compute/galleries/images",
                                    "constraints": {
                                        "required": true
                                    }
                                }
                            ]
                        },
                        {
                            "name": "SessionHostsSecuritySection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[and(equals(steps('SessionHosts').DeploySessionHosts, true), or(contains(steps('SessionHosts').SessionHostsOsSection.SessionHostsOsImage, 'win11'), contains(steps('SessionHosts').SessionHostsOsSection.SessionHostsOsImage, 'g2'), not(empty(steps('SessionHosts').SessionHostsOsSection.SessionHostsComputeGalleryImage))))]",
                            "label": "Security profile",
                            "elements": [
                                {
                                    "name": "SessionHostSecurityTypeWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[not(empty(steps('SessionHosts').SessionHostsOsSection.SessionHostsComputeGalleryImage))]",
                                    "options": {
                                        "text": "Setting the Security Type to anything other than 'Standard' requires that the Azure Compute Gallery Image Definition be configured with the Security Type feature set to the appropriate value. You can determine if the image definition supports the required feature by reviewing the 'Properties' tab on the 'Overview' node of the Gallery Image Definition in the portal. If the image definition does not contain these feature options, then the deployment will fail.",
                                        "uri": "https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/galleries/images?pivots=deployment-language-bicep",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "securityType",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Security type",
                                    "filter": true,
                                    "defaultValue": "Standard",
                                    "toolTip": "Choose a type of security that matches your needs: Standard includes basic protections at no additional cost. Trusted launch virtual machines provide additional security features on Gen2 virtual machines to protect against persistent and advanced attacks.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Standard",
                                                "value": "Standard"
                                            },
                                            {
                                                "label": "Trusted Launch Virtual Machines",
                                                "value": "TrustedLaunch"
                                            },
                                            {
                                                "label": "Confidential Virtual Machines",
                                                "value": "ConfidentialVM"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "secureBootEnabled",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[or(equals(steps('SessionHosts').SessionHostsSecuritySection.securityType, 'TrustedLaunch'), equals(steps('SessionHosts').SessionHostsSecuritySection.securityType, 'ConfidentialVM'))]",
                                    "label": "Enable secure boot",
                                    "defaultValue": "No",
                                    "toolTip": "Secure boot helps protect your VMs against boot kits, rootkits, and kernel-level malware.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "vTpmEnabled",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[or(equals(steps('SessionHosts').SessionHostsSecuritySection.securityType, 'TrustedLaunch'), equals(steps('SessionHosts').SessionHostsSecuritySection.securityType, 'ConfidentialVM'))]",
                                    "label": "Enable vTPM",
                                    "defaultValue": "No",
                                    "toolTip": "Virtual Trusted Platform Module (vTPM) is TPM2.0 compliant and validates your VM boot integrity apart from securely storing keys and secrets.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "Network",
                    "label": "Network connectivity",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "vnetInfoBox",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                            "options": {
                                "text": "AVD landing zone accelerator requires connectivity to identity services (ADDS, AADDS or AAD).",
                                "uri": "https://docs.microsoft.com/azure/virtual-desktop/authentication",
                                "style": "info"
                            }
                        },
                        {
                            "name": "createAvdVnet",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Virtual network",
                            "defaultValue": "New",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "New",
                                        "value": true
                                    },
                                    {
                                        "label": "Existing",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "VnetSize",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('Network').createAvdVnet, true)]",
                            "label": "vNet address range",
                            "toolTip": "Virtual network for AVD virtual machines",
                            "placeholder": "Example: 10.10.0.0/23",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 10 to 24."
                            }
                        },
                        {
                            "name": "VnetSubnetSize",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('Network').createAvdVnet, true)]",
                            "label": "Subnet address prefix",
                            "toolTip": "Virtual network subnet for AVD virtual machines",
                            "placeholder": "Example: 10.10.0.0/23",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 10 to 24."
                            }
                        },
                        {
                            "name": "VnetDns",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('Network').createAvdVnet, true)]",
                            "label": "Custom DNS Servers",
                            "defaultValue": "",
                            "placeholder": "Example: 10.10.100.4,10.10.100.5",
                            "toolTip": "Enter multiple IPs separated by a comma, if not provided Azure provided DNS will be used. Azure default DNS server (168.63.129.16) will be added as a last resort.",
                            "constraints": {
                                "regex": ""
                            }
                        },
                        {
                            "name": "ExistingVnetInfoBox",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('Network').createAvdVnet, false)]",
                            "options": {
                                "text": "Existing network must has connectivity to identity and DNS services.",
                                "uri": "https://docs.microsoft.com/azure/architecture/example-scenario/wvd/windows-virtual-desktop?context=/azure/virtual-desktop/context/context",
                                "style": "info"
                            }
                        },
                        {
                            "name": "VnetSelectorId",
                            "type": "Microsoft.Solutions.ResourceSelector",
                            "visible": "[equals(steps('Network').createAvdVnet, false)]",
                            "label": "Virtual network",
                            "resourceType": "Microsoft.Network/virtualNetworks",
                            "constraints": {
                                "required": true
                            },
                            "options": {
                                "filter": {
                                    "subscription": "onBasics",
                                    "location": "[steps('SessionHosts').SessionHostsRegionSection.SessionHostsRegion.location.displayName]"
                                }
                            }
                        },
                        {
                            "name": "SubnetApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "[concat(steps('Network').VnetSelectorId.id, '/subnets?api-version=2021-03-01')]"
                            }
                        },
                        {
                            "name": "VnetSubnetSelectorName",
                            "label": "Subnet",
                            "type": "Microsoft.Common.DropDown",
                            "visible": "[equals(steps('Network').createAvdVnet, false)]",
                            "defaultValue": "",
                            "toolTip": "Select the subnet.",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": true,
                            "filterPlaceholder": "Filter items ...",
                            "multiLine": true,
                            "constraints": {
                                "allowedValues": "[map(steps('Network').SubnetApi.value,(item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\",\"description\":\"', 'Resource Group: ', last(take(split(item.id, '/'), 5)), '\"}')))]",
                                "required": true
                            }
                        },
                        {
                            "name": "ExistingVnetInfoBoxPrivateEndpointWarning",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('Network').createAvdVnet, false)]",
                            "options": {
                                "text": "Private endpoint network policy needs to be disabled on the existing subnet before deploying AVD accelerator.",
                                "uri": "https://docs.microsoft.com/azure/private-link/disable-private-endpoint-network-policy",
                                "style": "Warning"
                            }
                        },
                        {
                            "name": "VnetPrivateDnsZone",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Azure private DNS zone (Private endpoints)",
                            "defaultValue": "Yes",
                            "toolTip": "It is recommended to use Azure private DNS zones for private endpoint name spaces (ALZ recommended and deployed).",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "VnetPrivateDnsZoneSelection",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('Network').VnetPrivateDnsZone, true)]",
                            "elements": [
                                {
                                    "name": "VnetPrivateDnsZoneFilesSelector",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true)]",
                                    "label": "File share (privatelink.file.core.windows.net)",
                                    "resourceType": "Microsoft.Network/privateDnsZones",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "VnetPrivateDnsZoneKeyvaultSelector",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "label": "Key vault (privatelink.vaultcore.azure.net)",
                                    "resourceType": "Microsoft.Network/privateDnsZones",
                                    "constraints": {
                                        "required": true
                                    }
                                }
                            ]
                        },
                        {
                            "name": "VnetPeeringInfoBox",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('Network').createAvdVnet, true)]",
                            "options": {
                                "text": "vNet peering will be created to existing vNet hub with access to identity and DNS services .",
                                "uri": "https://docs.microsoft.com/azure/architecture/example-scenario/wvd/windows-virtual-desktop?context=/azure/virtual-desktop/context/context",
                                "style": "info"
                            }
                        },
                        {
                            "name": "HubVnetPeering",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('Network').createAvdVnet, true)]",
                            "label": "Existing hub vNet peering information",
                            "elements": [
                                {
                                    "name": "HubVnetPeeringInfoBox",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD')]",
                                    "options": {
                                        "text": "vNet peering to identity services is not required when joining VMs to Azure AD .",
                                        "uri": "https://learn.microsoft.com/en-us/azure/architecture/example-scenario/wvd/azure-virtual-desktop-azure-active-directory-join",
                                        "style": "info"
                                    }
                                },
                                {
                                    "name": "HubVnetSubs",
                                    "type": "Microsoft.Solutions.ArmApiControl",
                                    "request": {
                                        "method": "GET",
                                        "path": "subscriptions?api-version=2020-01-01"
                                    }
                                },
                                {
                                    "name": "HubVnetSub",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "label": "Hub vNet Subscription",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": true,
                                    "filterPlaceholder": "Filter items ...",
                                    "multiLine": true,
                                    "constraints": {
                                        "allowedValues": "[map(steps('Network').HubVnetPeering.HubVnetSubs.value, (sub) => parse(concat('{\"label\":\"', sub.displayName, '\",\"description\":\"', sub.subscriptionId, '\",\"value\":\"', toLower(sub.subscriptionId), '\"}')) )]",
                                        "required": true
                                    }
                                },
                                {
                                    "name": "ExistingHubVnets",
                                    "type": "Microsoft.Solutions.ArmApiControl",
                                    "request": {
                                        "method": "GET",
                                        "path": "[concat('subscriptions/', steps('Network').HubVnetPeering.HubVnetSub, '/providers/Microsoft.Network/virtualNetworks?api-version=2021-08-01')]"
                                    }
                                },
                                {
                                    "name": "ExistingHubVnet",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "label": "Hub vNet",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": true,
                                    "filter": true,
                                    "filterPlaceholder": "Filter items ...",
                                    "multiLine": true,
                                    "constraints": {
                                        "allowedValues": "[map(steps('Network').HubVnetPeering.ExistingHubVnets.value, (vnet) => parse(concat('{\"label\":\"', vnet.name, '\",\"description\":\"', vnet.location, '\",\"value\":\"', toLower(vnet.id), '\"}')) )]",
                                        "required": true
                                    }
                                },
                                {
                                    "name": "HubVnetGateway",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[not(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'))]",
                                    "label": "Gateway on hub",
                                    "defaultValue": "No",
                                    "toolTip": "This information will be used to set remote gateway settings on vNet peering.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "Monitoring",
                    "label": "Monitoring",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "DeployMonitoring",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy monitoring",
                            "defaultValue": "Yes (Recommended)",
                            "toolTip": "Deploy monitoring settings and if selected deploy Azure log analytics workspace.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes (Recommended)",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "DeployMonitoringInfo1",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                            "options": {
                                "text": "Azure Virtual Desktop monitoring requires an existing Azure Log Analytics Workspace or the creation of a new one.",
                                "uri": "https://docs.microsoft.com/azure/virtual-desktop/azure-monitor",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "DeployMonitoringAlaWorkspace",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                            "label": "Log analytics workspace",
                            "defaultValue": "New",
                            "toolTip": "Deploy monitoring settings and if selected deploy Azure log analytics workspace.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "New",
                                        "value": true
                                    },
                                    {
                                        "label": "Existing",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "DeployMonitoringNewAlaWorkspaceRetention",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('Monitoring').DeployMonitoringAlaWorkspace, true)]", 
                            "label": "Retention policy (Days)",
                            "toolTip": "Number of days data will be retained in the workspace.",
                            "defaultValue": 90,
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z-]{1,90}$",
                                "validationMessage": "Value must be 1-90 characters."
                            }
                        },
                        {
                            "name": "AlaWorkspaceExistingWorkspacesSelection",
                            "type": "Microsoft.Solutions.ResourceSelector",
                            "visible": "[equals(steps('Monitoring').DeployMonitoringAlaWorkspace, false)]", 
                            "label": "Existing workspace",
                            "resourceType": "Microsoft.OperationalInsights/workspaces",
                            "constraints": {
                                "required": true
                            }
                        },
                        {
                            "name": "DeployMonitoringPolicies",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                            "label": "Deploy monitoring policies (subscription level)",
                            "defaultValue": "No",
                            "toolTip": "Deploy monitoring policy and policy set definitions to set diagnostic settings on new deployed resources.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "DeployMonitoringInfo2",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                            "options": {
                                "text": "Deployment will configured all required settings to use the AVD insights workbook.",
                                "uri": "https://learn.microsoft.com/azure/virtual-desktop/azure-monitor?WT.mc_id=Portal-AppInsightsExtension",
                                "style": "Info"
                            }
                        }
                    ]
                },
                {
                    "name": "ResourceNaming",
                    "label": "Resource naming",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "ResourceNamingInfo1",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "The AVD accelerator provides automated resource naming based on Microsoft best practices, default resources organization and naming is shown in this diagram.",
                                "uri": "https://github.com/Azure/avdaccelerator/blob/main/workload/docs/diagrams/avd-accelerator-resource-organization-naming.png",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "ResourceNamingSelection",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Custom resource naming",
                            "defaultValue": "No",
                            "toolTip": "When set 'Yes', the information provided will be used to name resources. When set to 'No' deployment will use the AVD accelerator naming standard.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "ResourceNamingWarning",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('ResourceNaming').ResourceNamingSelection, true)]",
                            "options": {
                                "text": "When using custom naming for resources, please make sure to follow naming rules and restrictions for Azure resources.",
                                "uri": "https://docs.microsoft.com/azure/azure-resource-manager/management/resource-name-rules",
                                "style": "Warning"
                            }
                        },
                        {
                            "name": "ResourceNamingAvdManagementPlane",
                            "type": "Microsoft.Common.Section",
                            "label": "AVD Management plane naming:",
                            "visible": "[equals(steps('ResourceNaming').ResourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "ServiceObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "toolTip": "AVD management plane resources (Workspace, Host pool, Application groups, Key vault) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-service-objects",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "WorkSpaceCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workspace",
                                    "toolTip": "AVD workspace custom name.",
                                    "placeholder": "Example: vdws-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "WorkSpaceCustomFriendlyName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workspace (Friendly name)",
                                    "toolTip": "AVD workspace custom friendly name.",
                                    "placeholder": "Example: East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "HostPoolCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Host pool",
                                    "toolTip": "AVD host pool custom name.",
                                    "placeholder": "Example: vdpool-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "HostPoolCustomFriendlyName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Host pool (Friendly name)",
                                    "toolTip": "AVD host pool custom friendly name.",
                                    "placeholder": "Example: App1 - East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "ScalingPlanCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Scaling Plan",
                                    "toolTip": "AVD host pool scaling plan.",
                                    "placeholder": "Example: vdscaling-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "ApplicationGroupCustomNameDesktop",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Desktop)",
                                    "toolTip": "AVD desktop application group custom name.",
                                    "placeholder": "Example: vdag-desktop-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "ApplicationGroupCustomFriendlyNameDesktop",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Desktop, Friendly name)",
                                    "toolTip": "AVD desktop application group custom name.",
                                    "placeholder": "Example: Desktops - App1 - East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "ApplicationGroupCustomNameRapp",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Remote App)",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneAppGroupOptions.DeployRappGroup, true)]",
                                    "toolTip": "AVD remote application group custom name.",
                                    "placeholder": "Example: vdag-rapp-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "ApplicationGroupCustomFriendlyNameRapp",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application group (Remote App, Friendly name)",
                                    "visible": "[equals(steps('ManagementPlane').ManagementPlaneAppGroupOptions.DeployRappGroup, true)]",
                                    "toolTip": "AVD remote application group custom name.",
                                    "placeholder": "Example: Remote apps - App1 - East US - 001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "WrklKvCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Key vault prefix",
                                    "toolTip": "AVD keyvault prefix custom name.",
                                    "placeholder": "Example: kv-avd",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,6}$",
                                        "validationMessage": "Value must be 1-6 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ResourceNamingCompute",
                            "type": "Microsoft.Common.Section",
                            "label": "Compute naming:",
                            "visible": "[equals(steps('ResourceNaming').ResourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "ComputeObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "toolTip": "AVD compute resources (VMs, NICs, Disks, Availability sets) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-pool-compute",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "ApplicationSecurityGroupCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Applications security group",
                                    "toolTip": "AVD application security custom name.",
                                    "placeholder": "Example: asg-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                },
                                {
                                    "name": "SessionHostCustomNamePrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Session host prefix",
                                    "visible": "[equals(steps('SessionHosts').DeploySessionHosts, true)]",
                                    "toolTip": "AVD session host prefix custom name.",
                                    "placeholder": "Example: vm-avd-app1",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,11}$",
                                        "validationMessage": "Value must be 1-11 characters."
                                    }
                                },
                                {
                                    "name": "AvailabilitySetCustomNamePrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Availability set prefix",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.SessionHostsAvailabilitySettings, false)]",
                                    "toolTip": "AVD availability set custom name.",
                                    "placeholder": "Example: avail-avd",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,9}$",
                                        "validationMessage": "Value must be 1-9 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ResourceNamingStorage",
                            "type": "Microsoft.Common.Section",
                            "label": "FSLogix storage naming:",
                            "visible": "[equals(steps('ResourceNaming').ResourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "ResourceNamingStorageInfo1",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating storage (FSLogix) resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "ResourceNamingStorageInfo2",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('SessionHosts').DeploySessionHosts, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating storage (FSLogix) resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "StorageObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true)]",
                                    "toolTip": "AVD storage resources (Storage account, file shares, files private endpoints, temporary domain join VM) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-storage",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "FslogixStorageCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Storage account prefix",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true)]",
                                    "toolTip": "AVD fslogix storage account prefix custom name.",
                                    "placeholder": "Example: stavd",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,5}$",
                                        "validationMessage": "Value must be 1-5 characters."
                                    }
                                },
                                {
                                    "name": "FslogixProfileContainerFileShareCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Profile container file share",
                                    "visible": "[equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true)]",
                                    "toolTip": "AVD fslogix storage account profile container file share prefix custom name.",
                                    "placeholder": "Example: fslogix-pc-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ResourceNamingNetwork",
                            "type": "Microsoft.Common.Section",
                            "label": "Network naming:",
                            "visible": "[equals(steps('ResourceNaming').ResourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "ResourceNamingNetworkInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('Network').createAvdVnet, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating network resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "NetworkObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "visible": "[equals(steps('Network').createAvdVnet, true)]",
                                    "toolTip": "AVD network resources (vNet, NSG, Route table) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-app1-network",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "VnetworkCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Virtual network",
                                    "visible": "[equals(steps('Network').createAvdVnet, true)]",
                                    "toolTip": "AVD virtual network custom name.",
                                    "placeholder": "Example: vnet-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,64}$",
                                        "validationMessage": "Value must be 1-64 characters."
                                    }
                                },
                                {
                                    "name": "VnetworkSubnetCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Subnet",
                                    "visible": "[equals(steps('Network').createAvdVnet, true)]",
                                    "toolTip": "AVD virtual network subnet custom name.",
                                    "placeholder": "Example: snet-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                },
                                {
                                    "name": "NetworksecurityGroupCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Network security group",
                                    "visible": "[equals(steps('Network').createAvdVnet, true)]",
                                    "toolTip": "AVD network security group custom name.",
                                    "placeholder": "Example: nsg-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                },
                                {
                                    "name": "RouteTableCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Route table",
                                    "visible": "[equals(steps('Network').createAvdVnet, true)]",
                                    "toolTip": "AVD route table custom name.",
                                    "placeholder": "Example: route-avd-use2-app1-001",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,80}$",
                                        "validationMessage": "Value must be 1-80 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ResourceNamingMonitoring",
                            "type": "Microsoft.Common.Section",
                            "label": "Monitoring naming:",
                            "visible": "[equals(steps('ResourceNaming').ResourceNamingSelection, true)]",
                            "elements": [
                                {
                                    "name": "ResourceNamingMonitoringInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('Monitoring').DeployMonitoring, false)]",
                                    "options": {
                                        "text": "Current deployment configuration is not creating monitoring resources.",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "MonitoringObjectsRgCustomName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource group",
                                    "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                                    "toolTip": "AVD monitoring resources (log analytics workspace) resource group custom name.",
                                    "placeholder": "Example: rg-avd-use2-monitoring",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                },
                                {
                                    "name": "MonitoringLogAnalyticsWorkspaceName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Log analytics workspace name",
                                    "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                                    "toolTip": "AVD monitoring log analytics workspace custom name.",
                                    "placeholder": "Example: log-avd-use2",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,90}$",
                                        "validationMessage": "Value must be 1-90 characters."
                                    }
                                }
                            ]
                        },
                        {
                            "name": "ResourceNamingInfo2",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "AVD accelerator has built-in resource naming automation based and best practices Microsoft Cloud Adoption Framework (CAF) naming convention.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "ResourceNamingInfo3",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "And abbreviations recommendations for Azure resource types.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-abbreviations",
                                "style": "Info"
                            }
                        }
                    ]
                },
                {
                    "name": "ResourceTagging",
                    "label": "Resource tagging",
                    "type": "Microsoft.Common.Section",
                    "visible": true,
                    "elements": [
                        {
                            "name": "ResourceTaggingSelection",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Create resource tags",
                            "defaultValue": "No",
                            "toolTip": "When set 'Yes', the information provided will be used to create tags on resources and resource groups.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
			    {
    				"name": "ResourceTaggingParentCostInfo",
    				"type": "Microsoft.Common.InfoBox",
    				"options": {
        				"text": "By default, all resources will be tagged with parent resource cost management tag (cm-resource-parent). This will group all costs under the host pool resource.",
        				"uri": "https://learn.microsoft.com/azure/virtual-desktop/tag-virtual-desktop-resources#use-the-cm-resource-parent-tag-to-automatically-group-costs-by-host-pool",
        				"style": "Info"
    				}
			},
                        {
                            "name": "ResourceTags",
                            "type": "Microsoft.Common.Section",
                            "label": "Resources tags:",
                            "visible": "[equals(steps('ResourceTagging').ResourceTaggingSelection, true)]",
                            "elements": [
                                {
                                    "name": "TagsWorkloadName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workload name:",
                                    "toolTip": "This input will be the value of a tag named WorkloadName.",
                                    "placeholder": "Example: Contoso-Workload",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "TagsWorkloadType",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Workload type:",
                                    "filter": true,
                                    "defaultValue": "Light",
                                    "toolTip": "This input will be the value of a tag named WorkloadType, reference to the size of the VM for your workloads.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Light",
                                                "description": "",
                                                "value": "Light"
                                            },
                                            {
                                                "label": "Medium",
                                                "description": "",
                                                "value": "Medium"
                                            },
                                            {
                                                "label": "High",
                                                "description": "",
                                                "value": "High"
                                            },
                                            {
                                                "label": "Power",
                                                "description": "",
                                                "value": "POwer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "TagsDataClassificationTag",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Data classification:",
                                    "filter": true,
                                    "defaultValue": "Non-business",
                                    "toolTip": "This input will be the value of a tag named DataClassification, reference to the sensitivity of data hosted.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Non-business",
                                                "description": "",
                                                "value": "Non-business"
                                            },
                                            {
                                                "label": "Public",
                                                "description": "",
                                                "value": "Public"
                                            },
                                            {
                                                "label": "General",
                                                "description": "",
                                                "value": "General"
                                            },
                                            {
                                                "label": "Confidential",
                                                "description": "",
                                                "value": "Confidential"
                                            },
                                            {
                                                "label": "Highly-confidential",
                                                "description": "",
                                                "value": "Highly-confidential"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "TagsDepartmentTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Department:",
                                    "toolTip": "This input will be the value of a tag named Department, reference the department that owns the deployment.",
                                    "placeholder": "Example: Contoso-AVD",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "TagsCriticalityTag",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Workload criticality:",
                                    "filter": true,
                                    "defaultValue": "Low",
                                    "toolTip": "This input will be the value of a tag named Criticality, reference to the criticality of the workload.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Low",
                                                "description": "",
                                                "value": "Low"
                                            },
                                            {
                                                "label": "Medium",
                                                "description": "",
                                                "value": "Medium"
                                            },
                                            {
                                                "label": "High",
                                                "description": "",
                                                "value": "High"
                                            },
                                            {
                                                "label": "Missin-critical",
                                                "description": "",
                                                "value": "Missin-critical"
                                            },
                                            {
                                                "label": "Custom",
                                                "description": "",
                                                "value": "Custom"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "TagsCustomWorkloadCriticality",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Custom workload criticality:",
                                    "visible": "[equals(steps('ResourceTagging').ResourceTags.TagsCriticalityTag, 'Custom')]",
                                    "toolTip": "This input will be the value of a tag named Criticality, reference to a custom criticality for the workload.",
                                    "placeholder": "Example: Contoso-Criticality",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "TagsApplicationNameTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application name:",
                                    "toolTip": "This input will be the value of a tag named ApplicationName, reference details about the application.",
                                    "placeholder": "Example: Contoso-App",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "TagsWorkloadSlaTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Workload SLA:",
                                    "toolTip": "This input will be the value of a tag named ServiceClass, reference to the service level agreement level of the worload.",
                                    "placeholder": "Example: Contoso-SLA",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "TagsOpsTeamTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Operations team:",
                                    "toolTip": "This input will be the value of a tag named OpsTeam, reference to the team accountable for day-to-day operations.",
                                    "placeholder": "Example: workload-admins@Contoso.com",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "TagsOwnerTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Owner:",
                                    "toolTip": "This input will be the value of a tag named Owner, reference to the organizational owner of the AVD deployment.",
                                    "placeholder": "Example: workload-owner@Contoso.com",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "TagsCostCenterTag",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Cost center:",
                                    "toolTip": "This input will be the value of a tag named CostCenter, reference to the cost center of owner team.",
                                    "placeholder": "Example: Contoso-CC",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9A-Z-]{1,256}$",
                                        "validationMessage": "Value must be 1-256 characters."
                                    }
                                },
                                {
                                    "name": "TagsEnvironmentTypeTag",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Environment type:",
                                    "filter": true,
                                    "defaultValue": "Dev",
                                    "toolTip": "This input will be the value of a tag named Environment, reference to the environment type of the workload.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Dev",
                                                "description": "",
                                                "value": "Dev"
                                            },
                                            {
                                                "label": "Staging",
                                                "description": "",
                                                "value": "Staging"
                                            },
                                            {
                                                "label": "Prod",
                                                "description": "",
                                                "value": "Prod"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        "outputs": {
            "parameters": {
                "deploymentPrefix": "[steps('basics').DeploymentPrefix]",
                "avdManagementPlaneLocation": "[steps('basics').ResourceScope.location.name]",
                "avdSessionHostLocation": "[steps('SessionHosts').SessionHostsRegionSection.SessionHostsRegion.location.name]",
                "avdWorkloadSubsId": "[steps('basics').ResourceScope.subscription.subscriptionId]",
                "avdHostPoolType": "[steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType]",
                "avdHostPoolLoadBalancerType": "[steps('ManagementPlane').ManagementPlaneHostPoolSettings.loadBalancerType]",
                "avhHostPoolMaxSessions": "[if(equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled'), steps('ManagementPlane').ManagementPlaneHostPoolSettings.maxSessions, 1)]",
                "avdPersonalAssignType": "[if(equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Personal'), steps('ManagementPlane').ManagementPlaneHostPoolSettings.assignmentType, 'Automatic')]",
                "avdDeployRappGroup": "[if(equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled'), steps('ManagementPlane').ManagementPlaneAppGroupOptions.DeployRappGroup, false)]",
                "avdIdentityServiceProvider": "[steps('Identity').IdentityDomainInformation.IdentityServiceProvider]",
                "createIntuneEnrollment": "[if(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'), steps('Identity').IdentityDomainInformation.IdentityServiceProviderIntuneEnrollment, false)]",
                "avdIdentityDomainName": "[if(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'), 'none', steps('Identity').IdentityDomainInformation.IdentityDomainName)]",
                "avdOuPath": "[if(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'), 'none', steps('SessionHosts').SessionHostsComputeStorageSection.IdentityDomainOuPath)]",
                "avdDomainJoinUserName": "[if(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'), 'none', steps('Identity').IdentityDomainCredentials.IdentityDomainJoinUserName)]",
                "avdDomainJoinUserPassword": "[if(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'), 'none', steps('Identity').IdentityDomainCredentials.IdentityDomainJoinUserPassword)]",
                "avdVmLocalUserName": "[steps('Identity').IdentityLocalCredentials.IdentityLocalUserName]",
                "avdVmLocalUserPassword": "[steps('Identity').IdentityLocalCredentials.IdentityLocalUserPassword.password]",
                "createAvdVnet": "[steps('Network').createAvdVnet]",
                "avdVnetworkAddressPrefixes": "[if(equals(steps('Network').createAvdVnet, true), steps('Network').VnetSize, '10.10.0.0/23')]",
                "avdVnetworkSubnetAddressPrefix": "[if(equals(steps('Network').createAvdVnet, true), steps('Network').VnetSubnetSize, '10.10.0.0/23')]",
                "customDnsIps": "[if(equals(steps('Network').createAvdVnet, true), steps('Network').VnetDns, 'none')]",
                "existingHubVnetResourceId": "[if(equals(steps('Network').createAvdVnet, true), steps('Network').HubVnetPeering.ExistingHubVnet, '')]",
                "vNetworkGatewayOnHub": "[if(equals(steps('Network').createAvdVnet, true), steps('Network').HubVnetPeering.HubVnetGateway, false)]",
                "existingVnetSubnetResourceId": "[if(equals(steps('Network').createAvdVnet, false), steps('Network').VnetSubnetSelectorName, 'none')]",
                "avdDeploySessionHosts": "[steps('SessionHosts').DeploySessionHosts]",
                "avdStartVmOnConnect": "[if(equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Personal'), steps('ManagementPlane').ManagementPlaneHostPoolScaling.startVmOnConnect, false)]",
                "avdDeployScalingPlan": "[if(equals(steps('ManagementPlane').ManagementPlaneHostPoolSettings.hostPoolType, 'Pooled'), steps('ManagementPlane').ManagementPlaneHostPoolScaling.ScalingPlan, false)]",
                "createStartVmOnConnectCustomRole": "[if(equals(steps('ManagementPlane').ManagementPlaneHostPoolScaling.startVmOnConnect, true), steps('ManagementPlane').ManagementPlaneHostPoolScaling.createVmRole, false)]",
                "avdEnterpriseAppObjectId": "[steps('ManagementPlane').ManagementPlaneHostPoolScaling.EnterApplication.objectId]",
                "avdUseAvailabilityZones": "[steps('SessionHosts').SessionHostsComputeStorageSection.SessionHostsAvailabilitySettings]",
                "avdDeploySessionHostsCount": "[if(equals(steps('SessionHosts').DeploySessionHosts, true), steps('SessionHosts').SessionHostsSettingsSection.SessionHostsCount, 1)]",
                "useSharedImage": "[if(equals(steps('SessionHosts').DeploySessionHosts, true), steps('SessionHosts').SessionHostsOsSection.SessionHostsImageSource, false)]",
                "avdOsImage": "[if(equals(steps('SessionHosts').SessionHostsOsSection.SessionHostsImageSource, false), steps('SessionHosts').SessionHostsOsSection.SessionHostsOsImage, 'win11_21h2')]",
                "securityType": "[steps('SessionHosts').SessionHostsSecuritySection.securityType]",
                "secureBootEnabled": "[steps('SessionHosts').SessionHostsSecuritySection.secureBootEnabled]",
                "vTpmEnabled": "[steps('SessionHosts').SessionHostsSecuritySection.vTpmEnabled]",
                "avdImageTemplateDefinitionId": "[if(equals(steps('SessionHosts').SessionHostsOsSection.SessionHostsImageSource, true), steps('SessionHosts').SessionHostsOsSection.SessionHostsComputeGalleryImage.id, 'none')]",
                "avdSessionHostDiskType": "[steps('SessionHosts').SessionHostsSettingsSection.SessionHostDiskType]",
                "avdSessionHostsSize": "[if(equals(steps('SessionHosts').DeploySessionHosts, true), steps('SessionHosts').SessionHostsSettingsSection.element1, 'Standard_D2s_v4')]",
                "createOuForStorage": "[if(equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true), steps('SessionHosts').SessionHostsComputeStorageSection.IdentityDomainOuPathBool, '')]",
                "avdVnetPrivateDnsZone": "[steps('Network').VnetPrivateDnsZone]",
                "avdVnetPrivateDnsZoneFilesId": "[if(equals(steps('Network').VnetPrivateDnsZone, true), steps('Network').VnetPrivateDnsZoneSelection.VnetPrivateDnsZoneFilesSelector.id, '')]",
                "avdVnetPrivateDnsZoneKeyvaultId": "[if(equals(steps('Network').VnetPrivateDnsZone, true), steps('Network').VnetPrivateDnsZoneSelection.VnetPrivateDnsZoneKeyvaultSelector.id, '')]",
                "createAvdFslogixDeployment": "[if(equals(steps('Identity').IdentityDomainInformation.IdentityServiceProvider, 'AAD'), false, steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment)]",
                "fslogixStorageSku": "[if(equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true), steps('SessionHosts').SessionHostsComputeStorageSection.StorageAccountSku, 'Standard_LRS')]",
                "avdFslogixFileShareQuotaSize": "[if(equals(steps('SessionHosts').SessionHostsComputeStorageSection.FslogixDeployment, true), steps('SessionHosts').SessionHostsComputeStorageSection.SessionHostsFslogixFileShareQuota, 1 )]",
                "storageOuPath": "[if(equals(steps('SessionHosts').SessionHostsComputeStorageSection.IdentityDomainOuPathBool, true), steps('SessionHosts').SessionHostsComputeStorageSection.IdentityDomainOuPathStorage, steps('SessionHosts').SessionHostsComputeStorageSection.IdentityDomainOuPathStorageExisting)]",
                "avdUseCustomNaming": "[steps('ResourceNaming').ResourceNamingSelection]",
                "avdServiceObjectsRgCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.ServiceObjectsRgCustomName, 'none')]",
                "avdNetworkObjectsRgCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingNetwork.NetworkObjectsRgCustomName, 'none')]",
                "avdComputeObjectsRgCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingCompute.ComputeObjectsRgCustomName, 'none')]",
                "avdStorageObjectsRgCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingStorage.StorageObjectsRgCustomName, 'none')]",
                "avdVnetworkCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingNetwork.VnetworkCustomName, 'none')]",
                "avdVnetworkSubnetCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingNetwork.VnetworkSubnetCustomName, 'none')]",
                "avdNetworksecurityGroupCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingNetwork.NetworksecurityGroupCustomName, 'none')]",
                "avdRouteTableCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingNetwork.RouteTableCustomName, 'none')]",
                "avdApplicationSecurityGroupCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingCompute.ApplicationSecurityGroupCustomName, 'none')]",
                "avdWorkSpaceCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.WorkSpaceCustomName, 'none')]",
                "avdWorkSpaceCustomFriendlyName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.WorkSpaceCustomFriendlyName, 'none')]",
                "avdHostPoolCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.HostPoolCustomName, 'none')]",
                "avdHostPoolCustomFriendlyName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.HostPoolCustomFriendlyName, 'none')]",
                "avdScalingPlanCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.ScalingPlanCustomName, 'none')]",
                "avdApplicationGroupCustomNameDesktop": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.ApplicationGroupCustomNameDesktop, 'none')]",
                "avdApplicationGroupCustomFriendlyName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.ApplicationGroupCustomFriendlyNameDesktop, 'none')]",
                "avdApplicationGroupCustomNameRapp": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.ApplicationGroupCustomNameRapp, 'none')]",
                "avdApplicationGroupCustomFriendlyNameRapp": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.ApplicationGroupCustomFriendlyNameRapp, 'none')]",
                "avdSessionHostCustomNamePrefix": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingCompute.SessionHostCustomNamePrefix, 'none')]",
                "avdAvailabilitySetCustomNamePrefix": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingCompute.AvailabilitySetCustomNamePrefix, 'none')]",
                "avdFslogixStoragePrefixCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingStorage.FslogixStorageCustomName, 'none')]",
                "avdFslogixProfileContainerFileShareCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingStorage.FslogixProfileContainerFileShareCustomName, 'none')]",
                "avdWrklKvPrefixCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingAvdManagementPlane.WrklKvCustomName, 'none')]",
                "createResourceTags": "[steps('ResourceTagging').ResourceTaggingSelection]",
                "workloadNameTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsWorkloadName, 'none')]",
                "workloadTypeTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsWorkloadType, 'Light')]",
                "dataClassificationTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsDataClassificationTag, 'Non-business')]",
                "departmentTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsDepartmentTag, 'none')]",
                "workloadCriticalityTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsCriticalityTag, 'Low')]",
                "workloadCriticalityCustomValueTag": "[if(equals(steps('ResourceTagging').ResourceTags.TagsCriticalityTag, 'Custom'), steps('ResourceTagging').ResourceTags.TagsCustomWorkloadCriticality, 'Low')]",
                "applicationNameTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsApplicationNameTag, 'none')]",
                "workloadSlaTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsWorkloadSlaTag, 'none')]",
                "opsTeamTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsOpsTeamTag, 'none')]",
                "ownerTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsOwnerTag, 'none')]",
                "costCenterTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsCostCenterTag, 'none')]",
                "environmentTypeTag": "[if(equals(steps('ResourceTagging').ResourceTaggingSelection, true), steps('ResourceTagging').ResourceTags.TagsEnvironmentTypeTag, 'Dev')]",
                "avdApplicationGroupIdentityType": "[steps('Identity').IdentityAvdUserAccess.IdentityAccessTypes]",
                "avdApplicationGroupIdentitiesIds": "[steps('Identity').IdentityAvdUserAccess.IdentityAccessIds]",
                "avdDeployMonitoring": "[steps('Monitoring').DeployMonitoring]",
                "deployAlaWorkspace": "[if(equals(steps('Monitoring').DeployMonitoring, true), steps('Monitoring').DeployMonitoringAlaWorkspace, false)]",
                "avdAlaWorkspaceDataRetention": "[if(equals(steps('Monitoring').DeployMonitoringAlaWorkspace, true), steps('Monitoring').DeployMonitoringNewAlaWorkspaceRetention, 0)]",
                "alaExistingWorkspaceResourceId": "[if(equals(steps('Monitoring').DeployMonitoringAlaWorkspace, false), steps('Monitoring').AlaWorkspaceExistingWorkspacesSelection.id, 'none')]",
                "deployCustomPolicyMonitoring": "[if(equals(steps('Monitoring').DeployMonitoring, true), steps('Monitoring').DeployMonitoringPolicies, false)]",
                "avdMonitoringRgCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingMonitoring.MonitoringObjectsRgCustomName, 'none')]",
                "avdAlaWorkspaceCustomName": "[if(equals(steps('ResourceNaming').ResourceNamingSelection, true), steps('ResourceNaming').ResourceNamingMonitoring.MonitoringLogAnalyticsWorkspaceName, 'none')]"
            },
            "kind": "Subscription",
            "location": "[steps('basics').ResourceScope.location.name]",
            "subscriptionId": "[steps('basics').ResourceScope.subscription.id]"
        }
    }
}
