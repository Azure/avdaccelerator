## Azure Virtual Desktop - Cost Estimate

![Azure Virtual Desktop accelerator diagram](./diagrams/avd-accelerator-baseline-architecture.png)

_Download a [Visio file](./diagrams/avd-accelerator-baseline-architecture.vsdx) of this architecture._

Azure Virtual Desktop resources and dependent services for establishing the baseline:

- Azure Virtual Desktop resources:
  - 1 Host Pool
  - 1 Desktop application group
  - 1 Workspace
  - Options to add personal and remote app host pools, workspaces, desktop application groups
  - 1 Session host VM (options to use custom image or marketplace image)
  - 1 Management VM (to run deployment scripts and domain join) **
  - Azure Virtual Desktop Monitoring, log analytics workspace and diagnostic logs enabled
  - Azure Virtual Desktop Scaling plan
  - Associated Desktop Application Group for personal
  - Associated Desktop Application Group and Remote Application Group for pooled
- Azure Files Storage with FSLogix share, RBAC role assignment and private endpoint **
- Azure Files Storage with App Attach share, RBAC role assignment and private endpoint **
- Application Security group
- Key Vault and private endpoint
- **Microsoft Defender Services** (enabled via policy):
  - **Microsoft Defender for Servers**: Provides threat detection, vulnerability assessment, and real-time security alerts for virtual machines.
  - **Microsoft Defender for Storage**: Secures Azure Files shares and other storage resources against unauthorized access or malware.
  - **Microsoft Defender for Key Vault**: Monitors and protects access to cryptographic keys and secrets.
  - **Microsoft Defender for Azure Resource Manager**: Detects suspicious management operations and protects the Azure management plane.

  ** Denotes resources only deployed in ADDS Identity scenario.

## Cost Breakdown

A breakdown of estimated cost for this deployment. Adjust to sku will change the estimates.
![Cost Estimate](./diagrams/cost-estimate.png)

58 were free:

- 20 x azurerm_log_analytics_datasource_windows_performance_counter
- 9 x azurerm_log_analytics_datasource_windows_event
- 5 x azurerm_resource_group
- 4 x azurerm_role_assignment
- 2 x azurerm_network_interface
- 2 x azurerm_private_dns_zone_virtual_network_link
- 2 x azurerm_subnet **
- 1 x azurerm_application_security_group
- 1 x azurerm_firewall_policy_rule_collection_group **
- 1 x azurerm_key_vault
- 1 x azurerm_key_vault_access_policy
- 1 x azurerm_key_vault_secret
- 1 x azurerm_network_security_group
- 1 x azurerm_storage_account_network_rules
- 1 x azurerm_subnet_network_security_group_association
- 1 x azurerm_user_assigned_identity
- 1 x azurerm_virtual_desktop_application_group
- 1 x azurerm_virtual_desktop_host_pool
- 1 x azurerm_virtual_desktop_workspace
- 1 x azurerm_virtual_desktop_workspace_application_group_association
- 1 x azurerm_virtual_network

** Denotes a current difference in resource deployment between Bicep and Terraform. Bicep deployment only deploys (1) subnet currently and only Terraform deployment deploys a firewall policy rule collection group.

Generated by: [Infracost](https://www.infracost.io/)

## Contributing

This project welcomes contributions and suggestions.  Most contributions require you to agree to a
Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us
the rights to use your contribution. For details, visit [https://cla.opensource.microsoft.com](https://cla.opensource.microsoft.com).

When you submit a pull request, a CLA bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions
provided by the bot. You will only need to do this once across all repos using our CLA.

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).
For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or
contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.

## Trademarks

This project may contain trademarks or logos for projects, products, or services. Authorized use of Microsoft
trademarks or logos is subject to and must follow
[Microsoft's Trademark & Brand Guidelines](https://www.microsoft.com/legal/intellectualproperty/trademarks).
Use of Microsoft trademarks or logos in modified versions of this project must not cause confusion or imply Microsoft sponsorship.
Any use of third-party trademarks or logos are subject to those third-party's policies.

## Reporting issues

Microsoft Support is not yet handling issues for any published tools in this repository. However, we would like to welcome you to open issues using GitHub [issues](https://github.com/Azure/avdaccelerator/issues) to collaborate and improve these tools.
