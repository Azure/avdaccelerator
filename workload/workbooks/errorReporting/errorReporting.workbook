{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "parameters": [
          {
            "id": "32cd0326-e61f-4ce2-ab7e-95d2f36d82a9",
            "version": "KqlParameterItem/1.0",
            "name": "Subscriptions",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::1",
                "value::10",
                "value::50",
                "value::all"
              ],
              "includeAll": true
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::10",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "affe94cd-b1e1-400d-8c26-c4433c14b4f9",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2419200000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "value": {
              "durationMs": 86400000
            }
          },
          {
            "id": "15272bb3-0262-4ba9-a25c-3921a246eb5c",
            "version": "KqlParameterItem/1.0",
            "name": "Workspaces",
            "type": 5,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources | where type =~ 'microsoft.operationalinsights/workspaces'\r\n| distinct id",
            "crossComponentResources": [
              "{Subscriptions}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::1",
                "value::5",
                "value::10",
                "value::all"
              ],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::10",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 0"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "6bc821ef-080f-4e4e-b66f-c4f33c7b7553",
            "cellValue": "controlTab",
            "linkTarget": "parameter",
            "linkLabel": "Report by Single Error",
            "subTarget": "single",
            "style": "link"
          },
          {
            "id": "6f1e6628-c159-4f91-aebf-6b1c0b34db08",
            "cellValue": "controlTab",
            "linkTarget": "parameter",
            "linkLabel": "Report by Multiple Errors",
            "subTarget": "multi",
            "style": "link"
          }
        ]
      },
      "name": "links - 2"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspaces}"
              ],
              "parameters": [
                {
                  "id": "bd69a5ca-e5cf-4480-9a2f-395f5f698553",
                  "version": "KqlParameterItem/1.0",
                  "name": "CodeSymbolic",
                  "type": 2,
                  "isRequired": true,
                  "query": "WVDErrors | summarize max(TimeGenerated) by CodeSymbolic\r\n| distinct CodeSymbolic",
                  "crossComponentResources": [
                    "{Workspaces}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::1"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::1",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": "ShortpathTransportNetworkDrop"
                },
                {
                  "id": "675a200f-45ff-48c4-81dc-e33b76e30f28",
                  "version": "KqlParameterItem/1.0",
                  "name": "SelectedPercent",
                  "type": 1,
                  "query": "WVDErrors\r\n| summarize ['Failure %']= round(toreal(countif(CodeSymbolic == '{CodeSymbolic}')) / toreal(count()) * 100.0, 3)\r\n| project ['Failure %']",
                  "crossComponentResources": [
                    "{Workspaces}"
                  ],
                  "isHiddenWhenLocked": true,
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 6"
          },
          {
            "type": 1,
            "content": {
              "json": "## {CodeSymbolic} represents {SelectedPercent}% of All Errors {TimeRange}"
            },
            "name": "text - 0"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "173a54dc-effa-4a6a-a7de-79793c74ed98",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Gateway Regions",
                  "subTarget": "gateway",
                  "preText": "Gateway Regions",
                  "style": "link"
                },
                {
                  "id": "afc23ae3-56fa-47a6-aada-72ebee6edb8d",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Users",
                  "subTarget": "user",
                  "style": "link"
                },
                {
                  "id": "a4c366f1-9fb7-4239-9eb8-bc0af37f8879",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Host Pools",
                  "subTarget": "hostpool",
                  "style": "link"
                },
                {
                  "id": "824b7ab2-dd85-4a93-bae0-e28c2a4921a7",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Session Host",
                  "subTarget": "sessionhost",
                  "style": "link"
                }
              ]
            },
            "name": "links - 6"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" \r\n| where GatewayRegion != \"<>\"\r\n| join kind=leftouter(WVDErrors) on CorrelationId \r\n| summarize ['Count {CodeSymbolic} Errors']=countif(CodeSymbolic == '{CodeSymbolic}'),\r\n            ['% {CodeSymbolic} Failure']= round(toreal(dcountif(CorrelationId, CodeSymbolic == '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),  \r\n            ['All Other Errors'] = dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}'),\r\n            ['% All Other Failures'] = round(toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),\r\n            ['TotalSessions'] = dcount(CorrelationId)\r\n        by UserName\r\n| sort by ['% {CodeSymbolic} Failure'] desc, TotalSessions desc\r\n",
                    "size": 2,
                    "title": "{CodeSymbolic} by UserName",
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "UserName",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "30ch"
                          }
                        },
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "338px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "164.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Avg Session Time",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 3600,
                            "palette": "redGreen"
                          },
                          "numberFormat": {
                            "unit": 24,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "name": "query - 2 - Users"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "user"
            },
            "name": "group - Single Error - User"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join kind=leftouter(WVDErrors) on CorrelationId \r\n| summarize ['Count {CodeSymbolic} Errors']=countif(CodeSymbolic == '{CodeSymbolic}'),\r\n            ['% {CodeSymbolic} Failure']= round(toreal(dcountif(CorrelationId, CodeSymbolic == '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),  \r\n            ['All Other Errors'] = dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}'),\r\n            ['% All Other Failures'] = round(toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),\r\n            ['TotalSessions'] = dcount(CorrelationId)\r\n        by GatewayRegion\r\n| sort by ['% {CodeSymbolic} Failure'] desc, TotalSessions desc",
                    "size": 2,
                    "title": "{CodeSymbolic} by Gateway Region",
                    "timeContextFromParameter": "TimeRange",
                    "exportFieldName": "GatewayRegion",
                    "exportParameterName": "gw",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "296.991px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "225px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "name": "query - 2 - Gateway Region"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" \r\n| where GatewayRegion != \"<>\"\r\n| where GatewayRegion == '{gw}'\r\n| where isnotempty(CodeSymbolic)\r\n| summarize Errors=count(), byCompany=dcountif(Company, isnotempty(CodeSymbolic)) by Hostpool=_ResourceId, CodeSymbolic, ClientOS, ClientVersion\r\n//| evaluate pivot(Company)",
                    "size": 0,
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "gridSettings": {
                      "sortBy": [
                        {
                          "itemKey": "Errors",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "Errors",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "name": "query - 1"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "gateway"
            },
            "name": "group - Single Error - Gateway Region"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join kind=leftouter(WVDErrors) on CorrelationId \r\n| summarize ['Count {CodeSymbolic} Errors']=countif(CodeSymbolic == '{CodeSymbolic}'),\r\n            ['% {CodeSymbolic} Failure']= round(toreal(dcountif(CorrelationId, CodeSymbolic == '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),  \r\n            ['All Other Errors'] = dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}'),\r\n            ['% All Other Failures'] = round(toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),\r\n            ['TotalSessions'] = dcount(CorrelationId)\r\n        by Hostpool = _ResourceId\r\n| sort by ['% {CodeSymbolic} Failure'] desc, TotalSessions desc",
                    "size": 2,
                    "title": "{CodeSymbolic} by Hostpool",
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "279.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "187px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "name": "query - 2 - Hostpool"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "hostpool"
            },
            "name": "group - Single Error - Hostpool"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" \r\n| where GatewayRegion != \"<>\"\r\n| join kind=leftouter(WVDErrors) on CorrelationId \r\n| summarize ['Count {CodeSymbolic} Errors']=countif(CodeSymbolic == '{CodeSymbolic}'),\r\n            ['% {CodeSymbolic} Failure']= round(toreal(dcountif(CorrelationId, CodeSymbolic == '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),  \r\n            ['All Other Errors'] = dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}'),\r\n            ['% All Other Failures'] = round(toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic) and CodeSymbolic != '{CodeSymbolic}')) / toreal(dcountif(CorrelationId, isnotempty(CodeSymbolic))) * 100.0, 3),\r\n            ['TotalSessions'] = dcount(CorrelationId)\r\n        by SessionHostName\r\n| sort by ['% {CodeSymbolic} Failure'] desc",
                    "size": 2,
                    "title": "{CodeSymbolic} by SessionHost",
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "279.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "187px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "name": "query - 2 - SessionHost"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "sessionhost"
            },
            "name": "group - Single Error - Session Host"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "controlTab",
        "comparison": "isEqualTo",
        "value": "single"
      },
      "name": "group - Single Error"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspaces}"
              ],
              "parameters": [
                {
                  "id": "bd69a5ca-e5cf-4480-9a2f-395f5f698553",
                  "version": "KqlParameterItem/1.0",
                  "name": "CodeSymbolic",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "WVDErrors | summarize max(TimeGenerated) by CodeSymbolic\r\n| distinct CodeSymbolic",
                  "crossComponentResources": [
                    "{Workspaces}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": [
                    "value::all"
                  ]
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 6"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "173a54dc-effa-4a6a-a7de-79793c74ed98",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Gateway Regions",
                  "subTarget": "gateway",
                  "preText": "Gateway Regions",
                  "style": "link"
                },
                {
                  "id": "afc23ae3-56fa-47a6-aada-72ebee6edb8d",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Users",
                  "subTarget": "user",
                  "style": "link"
                },
                {
                  "id": "a4c366f1-9fb7-4239-9eb8-bc0af37f8879",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Host Pools",
                  "subTarget": "hostpool",
                  "style": "link"
                },
                {
                  "id": "824b7ab2-dd85-4a93-bae0-e28c2a4921a7",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Session Host",
                  "subTarget": "sessionhost",
                  "style": "link"
                }
              ]
            },
            "name": "links - 6"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n    | where State == \"Completed\" \r\n    | where GatewayRegion != \"<>\"\r\n    | extend EndTime = TimeGenerated\r\n| join kind=leftouter(WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| top-nested 50 of UserName by Sessions=todouble(dcount(CorrelationId)),\r\n    top-nested 5 of CodeSymbolic by Errors=todouble(dcountif(CorrelationId, isnotempty(CodeSymbolic)))\r\n| extend ['Error Precent']= round((Errors / Sessions) * 100, 3)\r\n",
                    "size": 2,
                    "title": "Top 5 Errors by top 50 Users",
                    "timeContextFromParameter": "TimeRange",
                    "exportedParameters": [
                      {
                        "fieldName": "UserName",
                        "parameterName": "user",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "CodeSymbolic",
                        "parameterName": "exportSymbolic",
                        "parameterType": 1
                      }
                    ],
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "UserName",
                          "formatter": 5,
                          "formatOptions": {
                            "customColumnWidthSetting": "30ch"
                          }
                        },
                        {
                          "columnMatch": "CodeSymbolic",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Errors",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "red"
                          }
                        },
                        {
                          "columnMatch": "Error Precent",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "338px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "164.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Avg Session Time",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 3600,
                            "palette": "redGreen"
                          },
                          "numberFormat": {
                            "unit": 24,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "UserName"
                        ],
                        "expandTopLevel": true,
                        "finalBy": "CodeSymbolic"
                      }
                    },
                    "sortBy": []
                  },
                  "customWidth": "40",
                  "name": "query - Multi Error - Users",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let dsCompany = materialize(datatable(row:string)[\"{datasetCompany:escapejson}\"]\r\n| project row = todynamic(row)\r\n| mv-expand row\r\n| evaluate bag_unpack(row));\r\nWVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| join kind =leftouter(dsCompany) on UserName\r\n| where Company in~ ({Company}) or '*' in~ ({Company})\r\n| where CodeSymbolic == '{exportSymbolic}' and UserName == '{user}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by _ResourceId\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Hostpools with {exportSymbolic} Last 7d for User {user}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "_ResourceId",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and UserName == '{user}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by _ResourceId",
                          "size": 0,
                          "title": "{exportSymbolic} Last 7d for User {user}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - TimeChart for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let dsCompany = materialize(datatable(row:string)[\"{datasetCompany:escapejson}\"]\r\n| project row = todynamic(row)\r\n| mv-expand row\r\n| evaluate bag_unpack(row));\r\nWVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and UserName == '{user}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by _ResourceId\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Hostpools with {exportSymbolic} previous week for User {user}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "_ResourceId",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let dsCompany = materialize(datatable(row:string)[\"{datasetCompany:escapejson}\"]\r\n| project row = todynamic(row)\r\n| mv-expand row\r\n| evaluate bag_unpack(row));\r\nWVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and UserName == '{user}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by _ResourceId",
                          "size": 3,
                          "title": "{exportSymbolic} previous week for user {user}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Timechart for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "customWidth": "60",
                  "name": "group - Dynamic Charting"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "user"
            },
            "name": "group - User"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join kind=leftouter(WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| top-nested 10 of GatewayRegion by Sessions=todouble(dcount(CorrelationId)),\r\n    top-nested 5 of CodeSymbolic by Errors=todouble(dcountif(CorrelationId, isnotempty(CodeSymbolic)))\r\n| extend ['Error Precent']= round((Errors / Sessions) * 100, 3)",
                    "size": 2,
                    "title": "Top 5 Errors by Top 10 Gateway Regions",
                    "timeContextFromParameter": "TimeRange",
                    "exportedParameters": [
                      {
                        "fieldName": "GatewayRegion",
                        "parameterName": "gw"
                      },
                      {
                        "fieldName": "CodeSymbolic",
                        "parameterName": "exportSymbolic",
                        "parameterType": 1
                      }
                    ],
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "55.4286ch"
                          }
                        },
                        {
                          "columnMatch": "GatewayRegion",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "CodeSymbolic",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Errors",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "red"
                          }
                        },
                        {
                          "columnMatch": "Error Precent",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "55.4286ch"
                          }
                        },
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "296.991px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "225px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "GatewayRegion"
                        ],
                        "expandTopLevel": true,
                        "finalBy": "CodeSymbolic"
                      }
                    },
                    "sortBy": []
                  },
                  "customWidth": "40",
                  "name": "query - Multi Error - Gateway Region",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and GatewayRegion == '{gw}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by _ResourceId\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Hostpools with {exportSymbolic} Last 7d for Gateway Region {gw}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "_ResourceId",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and GatewayRegion == '{gw}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by _ResourceId",
                          "size": 0,
                          "title": "{exportSymbolic} Last 7d for Gateway Region {gw}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - TimeChart for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and GatewayRegion == '{gw}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by _ResourceId\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Hostpools with {exportSymbolic} previous week for Gateway Region {gw}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "_ResourceId",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and GatewayRegion == '{gw}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by _ResourceId",
                          "size": 3,
                          "title": "{exportSymbolic} previous week for Gateway Region {gw}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Timechart for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "customWidth": "60",
                  "name": "group - Dynamic Charting -  Gateway"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "gateway"
            },
            "name": "group - Gateway Region",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" \r\n| where GatewayRegion != \"<>\"\r\n| join kind=leftouter(WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| extend Hostpool = _ResourceId\r\n| top-nested 10 of Hostpool by Sessions=todouble(dcount(CorrelationId)),\r\n    top-nested 5 of CodeSymbolic by Errors=todouble(dcountif(CorrelationId, isnotempty(CodeSymbolic)))\r\n| extend ['Error Precent']= round((Errors / Sessions) * 100, 3)",
                    "size": 2,
                    "title": "Top 5 Errors by top 10 Hostpools",
                    "timeContextFromParameter": "TimeRange",
                    "exportedParameters": [
                      {
                        "fieldName": "CodeSymbolic",
                        "parameterName": "exportSymbolic",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "Hostpool",
                        "parameterName": "hostpool",
                        "parameterType": 5
                      }
                    ],
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true,
                            "customColumnWidthSetting": "49.2857ch"
                          }
                        },
                        {
                          "columnMatch": "Hostpool",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "CodeSymbolic",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Errors",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "red"
                          }
                        },
                        {
                          "columnMatch": "Error Precent",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "279.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "187px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Hostpool"
                        ],
                        "expandTopLevel": true,
                        "finalBy": "CodeSymbolic"
                      }
                    },
                    "sortBy": []
                  },
                  "customWidth": "40",
                  "name": "query - 2 - Multi Error - Hostpool",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and _ResourceId == '{hostpool}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by UserName\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Users with {exportSymbolic} Last 7d for Hostpool {hostpool:label}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "UserName",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let dsCompany = materialize(datatable(row:string)[\"{datasetCompany:escapejson}\"]\r\n| project row = todynamic(row)\r\n| mv-expand row\r\n| evaluate bag_unpack(row));\r\nWVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and _ResourceId == '{hostpool}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by UserName",
                          "size": 0,
                          "title": "Users with {exportSymbolic} Last 7d for Hostpool {hostpool:label}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - TimeChart for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and _ResourceId == '{hostpool}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by UserName\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Users with {exportSymbolic} previous week for Hostpool {hostpool:label}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "UserName",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and _ResourceId == '{hostpool}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by UserName",
                          "size": 3,
                          "title": "Users with {exportSymbolic} previous week for Hostpool {hostpool:label}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Timechart for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "customWidth": "60",
                  "name": "group - Dynamic Charting Hostpool"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "hostpool"
            },
            "name": "group - Hostpool"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "WVDConnections\r\n| where State == \"Completed\" \r\n| where GatewayRegion != \"<>\"\r\n| join kind=leftouter(WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| top-nested 50 of SessionHostName by Sessions=todouble(dcount(CorrelationId)),\r\n    top-nested 5 of CodeSymbolic by Errors=todouble(dcountif(CorrelationId, isnotempty(CodeSymbolic)))\r\n| extend ['Error Precent']= round((Errors / Sessions) * 100, 3)",
                    "size": 2,
                    "title": "Top 5 Errors by top 50 SessionHost",
                    "timeContextFromParameter": "TimeRange",
                    "exportedParameters": [
                      {
                        "fieldName": "CodeSymbolic",
                        "parameterName": "exportSymbolic",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "SessionHostName",
                        "parameterName": "sessionhost",
                        "parameterType": 1
                      }
                    ],
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SessionHostName",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "CodeSymbolic",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Errors",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "red"
                          }
                        },
                        {
                          "columnMatch": "Error Precent",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "% ShortpathTransportNetworkDrop Failure",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "279.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "% All Other Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "187px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "TotalSessions",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "Selected Failure %",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "greenRed",
                            "customColumnWidthSetting": "155.997px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Percent All Failures",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed",
                            "customColumnWidthSetting": "154px"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "SessionHostName"
                        ],
                        "expandTopLevel": true,
                        "finalBy": "CodeSymbolic"
                      }
                    },
                    "sortBy": []
                  },
                  "customWidth": "40",
                  "name": "query - Multi Error - SessionHost",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and SessionHostName == '{sessionhost}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by UserName\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Users with {exportSymbolic} Last 7d for SessionHost {sessionhost}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "UserName",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and SessionHostName == '{sessionhost}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from now(-7d) to now() step 4h by UserName",
                          "size": 0,
                          "title": "Users with {exportSymbolic} Last 7d for SessionHost {sessionhost}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - TimeChart for selected Error - Last 7d",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and SessionHostName == '{sessionhost}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by UserName\r\n| extend Errors = array_sum(errorsSeries)\r\n| top 5 by Errors",
                          "size": 3,
                          "title": "Top 5 Users with {exportSymbolic} previous week for SessionHost",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "UserName",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "Errors",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "red"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "errorsSeries",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "greenRed"
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "showLegend": true,
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Top 5 for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "WVDConnections\r\n| where State == \"Completed\" or State == \"Started\"\r\n| where GatewayRegion != \"<>\"\r\n| join (WVDErrors | where CodeSymbolic in~ ({CodeSymbolic}) or \"*\" in ({CodeSymbolic})) on CorrelationId \r\n| where CodeSymbolic == '{exportSymbolic}' and SessionHostName == '{sessionhost}'\r\n| make-series errorsSeries=dcountif(CorrelationId, isnotempty(CodeSymbolic)) on TimeGenerated from ago(14d) to ago(7d) step 4h by UserName",
                          "size": 3,
                          "title": "Users with {exportSymbolic} previous week for Hostpool {hostpool:label}",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "areachart",
                          "chartSettings": {
                            "xAxis": "TimeGenerated",
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - Multi Error - Timechart for selected Error - Previous Week",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "customWidth": "60",
                  "name": "group - Dynamic Charting SessionHost",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "sessionhost"
            },
            "name": "group - Session Host",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "controlTab",
        "comparison": "isEqualTo",
        "value": "multi"
      },
      "name": "group - 6 - Multi Error"
    }
  ],
  "fallbackResourceIds": [
    "Azure Monitor"
  ],
  "fromTemplateId": "community-Workbooks/byork/avderrorreporting",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}